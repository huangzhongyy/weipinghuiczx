(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'");}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){var Http=require("../../plugins/modules/http/httpV2.js");
var urlParam=require("../../plugins/urlParam.js");var mod={getSwitchUrl:"//mapi.vip.com/vips-mobile/rest/ugc/reputation/switch/get_for_pc",get:function(switchNames){var params=urlParam.get({switchNames:switchNames});Http({url:this.getSwitchUrl,data:params,jsonp:"callback",jsonpCallback:"getSwitchCB",dataType:"jsonp",cache:true,timeout:8E3,ajaxTryTimes:1,successCallback:function(re){if(re.code==1&&re.data)$.Listeners.pub("getSwitch.success").success(re.data);else $.Listeners.pub("getSwitch.fail").success()},
errorCallback:function(){$.Listeners.pub("getSwitch.fail").success()}})}};module.exports=mod},{"../../plugins/modules/http/httpV2.js":24,"../../plugins/urlParam.js":28}],2:[function(require,module,exports){var marsCid=require("./../../../../plugins/mars_cids/index");var cartHost=VIPSHOP.cartHost;var addUrl=cartHost+"/add.php";var checkUrl=cartHost+"/check_cart.php";var commErrData={code:500,msg:"\u64cd\u4f5c\u5931\u8d25",result:0};var Cart={events:{addSuccess:"cart.add.success",addFail:"cart.add.fail",
overHaitaoPolicy:"cart.add.overHaitaoPolicy",sellout:"cart.add.sellout",cartIsFull:"cart.add.cartIsFull",needCaptcha:"cart.add.needCaptcha",captchaErr:"cart.add.captchaErr",captchaEmpty:"cart.add.captchaEmpty",editSuccess:"cart.edit.success",editFail:"cart.edit.fail",removeSuccess:"cart.remove.success",removeFail:"cart.remove.fail",checkSuccess:"cart.check.success",checkFail:"cart.check.fail",askSuccess:"cart.askInfo.success",askFail:"cart.askInfo.fail",askLogin:"cart.ask.login",addMars:"cart.add.mars"},
getList:function(paramObj,type){var paramData={},_this=this;type=0;for(var key in paramObj)paramData[key]=paramObj[key];switch(type){case 1:_this.url=VIPSHOP.cartHost+"/getCartList.php";break;default:_this.url=VIPSHOP.cartHost+"/cart.php";break}$.ajax({url:_this.url,data:paramData,dataType:"jsonp",timeout:6E3,success:function(re){var eventType=Cart.events.askSuccess;if(type)switch(re.code){case 200:eventType=Cart.events.askSuccess;break;case 2001:eventType=Cart.events.askLogin;break;default:eventType=
Cart.events.askFail;break}$.Listeners.pub(eventType).success(re)},error:function(){$.Listeners.pub(Cart.events.askFail).success()}})},add:function(paramObj,callback,options,marsObj){var paramData={};var act;if($.isArray(paramObj)){for(var i=0,iMax=paramObj.length;i<iMax;i++){var item=paramObj[i];for(var key in item){var val=item[key];paramData[key]?paramData[key].push(val):paramData[key]=[val]}}act="mul"}else{for(var key in paramObj)paramData[key]=paramObj[key];act=""}if(options&&options.act)act=
options.act;paramData.act=act;paramData.client_time=Math.round((new Date).getTime()/1E3);var mars_cid=$.Cookie.get("mars_cid");if(!mars_cid)if(marsCid){mars_cid=marsCid.creat();$.Cookie.set("mars_cid",mars_cid,".vip.com","/",17520)}paramData.mars_cid=mars_cid;$.ajax({url:addUrl,data:paramData,timeout:8E3,dataType:"jsonp",jsonpCallback:"addCart",success:function(rtnData){var isSuccess=rtnData.code==200;var event=Cart.events.addFail;switch(rtnData.code){case 200:event=Cart.events.addSuccess;break;case 6005:event=
Cart.events.overHaitaoPolicy;break;case 7002:event=Cart.events.sellout;break;case 4E3:event=Cart.events.cartIsFull;break;case 2006:event=Cart.events.needCaptcha;$.Var.set("fds_info",rtnData.fds_info);break;case 5003:event=Cart.events.captchaErr;break;case 5E4:event=Cart.events.captchaEmpty;break;default:event=Cart.events.addFail;break}$.Listeners.pub(event).success({isSuccess:isSuccess,code:rtnData.code,result:rtnData.result,msg:rtnData.msg,param:paramData});callback&&callback(rtnData,isSuccess,paramData)},
error:function(XMLHttpRequest,textStatus){$.Listeners.pub(Cart.events.addFail).success({isSuccess:false,code:commErrData.code,result:commErrData.result,msg:commErrData.msg,param:paramData});callback&&callback(commErrData,false,paramData,textStatus)}});if(marsObj&&(marsObj.scene_id&&(marsObj.brand_id&&marsObj.goods_id)))$.Listeners.pub(Cart.events.addMars).success({scene_id:marsObj.scene_id,brand_id:marsObj.brand_id,goods_id:marsObj.goods_id})},checkCart:function(callback){$.ajax({url:checkUrl,jsonpCallback:"check_cart",
dataType:"jsonp",timeout:8E3,success:function(rtnData){var isSuccess=false;if(rtnData.code==0||(rtnData.code==1||rtnData.code==2)){isSuccess=true;$.Listeners.pub(Cart.events.checkSuccess).success({isSuccess:isSuccess,code:rtnData.code,msg:rtnData.msg,unGoodsList:rtnData.unGoodsList,endTime:rtnData.end_time})}else $.Listeners.pub(Cart.events.checkFail).success({isSuccess:false,code:rtnData.code,msg:rtnData.msg});callback&&callback(isSuccess,rtnData.code,rtnData.msg,rtnData.end_time)},error:function(){callback&&
callback(false,commErrData.code,commErrData.msg,null);$.Listeners.pub(Cart.events.checkFail).success({isSuccess:false,data:null,code:commErrData.code,msg:commErrData.msg})}})}};module.exports=Cart},{"./../../../../plugins/mars_cids/index":23}],3:[function(require,module,exports){var Modal=require("./modules/modal");var Ads=require("./modules/ads");var payAdapter=require("./modules/list/pay-adapter");var mergeAdapter=require("./modules/list/merge-adapter");var modifyAdapter=require("./modules/list/modify-adapter");
var cancelAdapter=require("./modules/list/cancel-adapter");var removeAdapter=require("./modules/list/remove-adapter");var returnAdapter=require("./modules/list/return-adapter");var returnCancelAdapter=require("./modules/list/return-cancel-adapter");var doCancelAdapter=require("./modules/list/do-cancel-adapter");var doMergeAdapter=require("./modules/list/do-merge-adapter");var CommonPop=require("../../plugins/modules/ui/modules/CommonPop");var trackAdapter=require("./modules/list/track-adapter");var receiptAdapter=
require("./modules/list/receipt-adapter");var template=require("./modules/list/template");var RebuyModule=require("./modules/rebuy");var AfterSalePop=require("./modules/afterSalePop");var ExchangePop=require("./modules/exchangePop");var getSwitch=require("../../bo/switch/index.js");require("./modules/jquery.form");var VIP_IMG_DOMAIN="//a.appsimg.com";var Config={getOrderListTab:"//order.vip.com/order/getOrderListTab",vsccardVerifiyUrl:"//order.vip.com/vsccard/sendcode",vscVerifiyUrl:"//order.vip.com/vsc/sendcode",
vscPayCheck:"//order.vip.com/vsc/payCheck",vsccardPayCheck:"//order.vip.com/vsccard/payCheck",wallet:"/order/wallet",cancelOrder:"//order.vip.com/vsc/cancelOrder",vsccardCancelOrder:"//order.vip.com/vsccard/cancelOrder",vsccarCancelOrder:"//order.vip.com/vsccar/cancelOrder",vsccarPayCheck:"//order.vip.com/vsccar/payCheck",uploadRemittance:"//order.vip.com/vsccar/upload/voucher",delRemittance:"//order.vip.com/vsccar/image/delete",saveRemittance:"//order.vip.com/vsccar/image/save",getPayerInfos:"//order.vip.com/haitao/getPayerInfos",
updateOrderPayer:"//order.vip.com/haitao/updateOrderPayer",getRelatedOrders:"//order.vip.com/order/getLinkageOrders",iframeWindow:0,remittanceUpload:{},idCardVerify:{weight:[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],modMap:["1","0","X","9","8","7","6","5","4","3","2"]}};var Order={init:function(){this.subEvent();var oldModalShow=Modal.prototype.show,oldModalHide=Modal.prototype.hide;var isIE6="undefined"==typeof document.body.style.maxHeight;Modal.prototype.show=function(){oldModalShow.apply(this);if(isIE6){$(".u-ie6-select-mask").length==
0&&$("#J_order_status").before('<iframe frameborder="0" scrolling="no" class="u-ie6-select-mask"></iframe>');$(".u-ie6-select-mask").show()}};Modal.prototype.hide=function(){oldModalHide.apply(this);if(isIE6)$(".u-ie6-select-mask").hide()};$("#J_modal_timeout").hide();$(document).ajaxComplete(function(event,XMLHttpRequest,ajaxOptions){try{var obj=$.parseJSON(XMLHttpRequest.responseText.replace(/^jQuery\d+_{1}\d+\({1}/,"").replace(/\){1}$/,""));if(obj.code&&obj.code===120)location.href="https://passport.vip.com/login?src="+
location.href}catch(exception){VIPSHOP.log("somethinf wrong~")}});this.modalAlert=new Modal({element:"#J_modal_general"});this.modalConfirm=new Modal({element:"#J_modal_confirm"});this.modalCountdown=new Modal({element:"#J_modal_countdown"});this.modalWalletWarning=new Modal({element:"#J_modal_wallet_warning"});this.modalOnceMore=new Modal({element:"#J_modal_pay_once_more"});this.modalOnceMoreMobileOnly=new Modal({element:"#J_modal_pay_once_more_mobile_only"});this.modalNoStock=new Modal({element:"#J_modal_no_stock"});
this.modalPartInStock=new Modal({element:"#J_modal_part_in_stock"});this.modalCheckRelatedOrders=new Modal({element:"#J_cancel_relative_orders_modal"});this.modalCancel=new Modal({element:"#J_modal_cancel"});this.modalCancelSuccess=new Modal({element:"#J_modal_cancel_success"});this.modalMerge=new Modal({element:"#J_modal_merge"});this.modalMergeEmpty=new Modal({element:"#J_modal_merge_empty"});this.modalMergeConfirm=new Modal({element:"#J_modal_merge_confirm"});this.modalMergeSuccessWithMessage=
new Modal({element:"#J_modal_mergeSuccessWithMessage"});this.modalMergeSuccess=new Modal({element:"#J_modal_mergeSuccess"});this.modalMergePaybackFail=new Modal({element:"#J_modal_merge_paybackFail"});this.modalReturnComfire=new Modal({element:"#J_modal_return_confirm"});this.modalVscComfire=new Modal({element:"#J_modal_vsc_confirm"});this.modalVerifyAlert=new Modal({element:"#J_modal_verify"});this.$orderList=$("#J_order_list");this.mergeRowTpl=$("#J_merge_row").html();this.payStockTpl=$("#J_pay_stock_row").html();
this.mergeAlipayTpl=$("#J_merge_alipay_tpl").html();this.mergeAlipayFirstTpl=$("#J_merge_alipay_first_tpl").html();this.onceMoreStates="has-deal has-no-deal has-no-delivery";var _payTypeStates=["pay-no-alipay","pay-no-pos","pay-all-available"];this.payTypeStates={all:_payTypeStates.join(" ")};this.payTypeStates[mergeAdapter.DELIVERY_NO_ALIPAY]=_payTypeStates[0];this.payTypeStates[mergeAdapter.DELIVERY_NO_POS]=_payTypeStates[1];this.payTypeStates[mergeAdapter.DELIVERY_ALL_AVAILABLE]=_payTypeStates[2];
var getSearchParam=function(key){var pairs=location.search.replace("?","").replace("script","_").replace("function","_").split("&");var pair;var pairSplit;for(var i=0,l=pairs.length;i<l;i++){pair=pairs[i];pairSplit=pair.split("=");if(pairSplit[0]===key)return pairSplit[1]}};this.$orderList.find("option").prop("selected",false).eq(parseInt(getSearchParam("status")||"0")).prop("selected",true);var that=this;var getSecondlyPayModal=function(result){};var aBrowser=["webkitTransition","mozTransition",
"msTransition","transition"];var isTransition=false;var isBrowser="";for(var i=0,len=aBrowser.length;i<len;i++)if(aBrowser[i]in document.createElement("div").style){isTransition=true;isBrowser=aBrowser[i].replace(/transition/i,"");break}$(".ui-tab").each(function(){var oPanel=$(this).find(".ui-tab-panel");var oLine=oPanel.find(".line");var aItem=oPanel.find('li:not(".line")');var aCont=$(this).find(".ui-tab-content");var fStyle=null;if(isTransition)fStyle=function(w,l){oLine.css({width:w,left:l})};
else fStyle=function(w,l){oLine.stop(true,false).animate({width:w,left:l},300)};var start_w,start_l;aItem.each(function(num){var $this=$(this);var timer=null;$this.on("click","a",function(){start_w=$this.outerWidth();start_l=$this.position().left;fStyle(start_w,start_l);$this.addClass("z-current").siblings("li").removeClass("z-current")})})});var channelUrl=_tabChannel;var channelDate=this.getUrlObject();var $container=this.$orderList.addClass("J-status-loading");$.ajax({url:channelUrl,data:channelDate}).fail(function(data){$container.removeClass("J-status-loading").addClass("J-status-fail")}).done(function(data){$container.removeClass("J-status-loading J-status-fail").html(data);
$.Listeners.pub("mars.track").success();RebuyModule.init(that).checkOrders(that.$orderList);AfterSalePop.checkOrders(that.$orderList);ExchangePop.checkOrders(that.$orderList);getSwitch.get("koubei_switch")});this.$orderList.on("click","#J-drop-menu li",$.proxy(this.filter,this));var _self=this;this.$orderList.on("click",".J_list_retry",$.proxy(this.pageReload,this)).on("click",".J_retry",$.proxy(this.filter,this)).on("click",".J_delete",$.proxy(this.remove,this)).on("click",".J_pay",$.proxy(this.pay,
this)).on("click",".J_merge",$.proxy(this.merge,this)).on("click",".J_modify",function(e){e.preventDefault();Order.modify($(this).parents("tbody").data("ordersn"))}).on("click",".J_return_cancel",$.proxy(this.returnGoodsCancel,this)).on("click",".J_rebuy",$.proxy(this.rebuy,this)).on("click",".J_saleago",$.proxy(this.receive,this)).on("click",".J_show_more",$.proxy(this.showMore,this)).on("click",".J_modify_payer",$.proxy(this.modifyPayer,this)).on("mouseenter",".J_track",$.proxy(this.track,this)).on("click",
".J_cancel",function(e){that.checkRelatedOrders(e)}).on("click",".J_return",function(e){that.returnGoods(e)}).on("click",".J_vsc_cancel",function(e){that.vscGoodsCancel(e)}).on("click",".J_vsc_pay",function(e){that.vscGoodsPay(e)}).on("click",".J-vsc-verifiy",function(e){that.vscVerifiy(e)}).on("click",".J_vsccard_cancel",function(e){that.vsccardGoodsCancel(e)}).on("click",".J_vsccard_pay",function(e){that.vsccardGoodsPay(e)}).on("click",".J-vsccard-verifiy",function(e){that.vsccardVerifiy(e)}).on("click",
".J_vsccar_cancel",function(e){that.vsccarGoodsCancel(e)}).on("click",".J_vsccar_pay",function(e){that.vsccarGoodsPay(e)}).on("click",".J_vsccar_uploadRemittance",function(e){that.remittanceDialog(e)}).on("click",".J_vsccar_payType",function(e){that.payTypeDialog(e)});this.modalPartInStock.element.on("click",".J_rebuy_stock",function(){var href=$(this).attr("href");var callback=$(this).data("callback");$.getJSON(href,function(res){if(res.code===200||res.result==1)location.href=callback;else that.alert(res.msg)});
return false}).on("click",".J_rebuy_cancel",function(){location.reload()});this.modalAlert.element.on("click",".J_close",function(){location.reload()});this.modalNoStock.element.on("click",".J_close",function(){location.reload()});var modalOnceMoreEl=this.modalOnceMore.element;modalOnceMoreEl.find(".ui-btn3").on("hover",function(){if(modalOnceMoreEl.hasClass("has-deal"))modalOnceMoreEl.find(".J_tooltip").toggle()});var modalCancelEl=this.modalCancel.element;var $question=modalCancelEl.find(".question");
modalCancelEl.on("click",".J_ok",function(){if(modalCancelEl.find(":checked").length===0){var $tip=modalCancelEl.find(".u-pop-tips").show();setTimeout(function(){$tip.hide()},1500)}else{that.doCancel();var okBtn=modalCancelEl.find(".J_ok");if(okBtn.hasClass("ui-btn-disable"))return;okBtn.addClass("ui-btn-disable")}}).on("click",".J_close",function(){modalCancelEl.find(":checked").prop("checked",false);modalCancelEl.find(".J_issue_pay").hide()});modalCancelEl.on("change","[type=radio]",function(){var $this=
$(this);modalCancelEl.find(".ui-tips-pop").hide();if($this.is(":checked")){var $tip=$this.siblings(".ui-tips-pop");if($tip.is(".J_issue_info, .J_issue_coupon")&&cancelAdapter.modifyEnabled||$tip.is(".J_issue_pay")&&cancelAdapter.payOnDelivery)$tip.show();$question.toggle($this.is("[id=reason7]"))}});var modalMergeEl=this.modalMerge.element;modalMergeEl.on("click",".J_ok",function(){if(modalMergeEl.find("[type=checkbox]:checked:not([disabled])").length===0){var $tip=modalMergeEl.find(".u-pop-tips").show();
setTimeout(function(){$tip.hide()},1500)}else{that.modalMerge.hide();if(mergeAdapter.isCoupon)that.confirm(that.modalMergeConfirm,"",$.proxy(that.doMerge,that));else that.doMerge()}});this.modalMergeConfirm.element.on("click",".J_close",function(){that.modalMerge.show()});this.$orderList.on("click",".J_uploadid",function(){var href=$(this).attr("href");window.open(template(href,{receiver:$(this).parents("tbody").data("receiver")}),"_blank");return false})},subEvent:function(){$.Listeners.sub("getSwitch.success").onsuccess(function(data){if(data.koubei_switch)$(".J_comment").removeClass("hidden")})},
getUrlObject:function(){var url=location.href;var paraString=url.substring(url.indexOf("?")+1,url.length).split("&");var paraObj={tabChannel:"all"};for(var i=0;i<paraString.length;i++){var j=paraString[i];try{paraObj[j.substring(0,j.indexOf("="))]=decodeURIComponent(j.substring(j.indexOf("=")+1,j.length))}catch(e){paraObj[j.substring(0,j.indexOf("="))]=OrderSearch.fallbackParam()||j.substring(j.indexOf("=")+1,j.length)}}var $tabChannel=paraObj.tabChannel;if($tabChannel){var $channelTab=$("#J_channel_tab").find('li:not(".line")');
var $tabChannelList=[];for(var i=0;i<$channelTab.length;i++)$tabChannelList.push($channelTab.eq(i).data("value"));var l=$.inArray(paraObj.tabChannel,$tabChannelList);$channelTab.eq(l).find("a").trigger("click")}return paraObj},pageReload:function(){location.reload()},getWalletStatus:function(){var that=this;$.getJSON(Config.wallet,function(res){that.walletStatus=res.walletstatus||false})},alert:function(message){this.modalAlert.element.find(".J_message").html(message);this.modalAlert.show()},verifyAlert:function(message){this.modalVerifyAlert.element.find(".J_message").html(message);
this.modalVerifyAlert.show()},confirm:function(modal,message,cb){if(message)modal.element.find(".J_message").text(message);modal.show();if(cb)modal.element.find(".J_ok").off("click").on("click",cb)},params:function(adapter,el){var $tbody=$(el).parents("tbody");var hasOwn=Object.prototype.hasOwnProperty;for(var k in adapter.params)if(hasOwn.call(adapter.params,k))adapter.params[k]=$tbody.data(k)},countdown:function(modal,message,count,cb){var el=modal.element;var $count=el.find(".J_count");el.find(".J_message").html(message);
count=count?parseInt(count,10):parseInt($count.html(),10);count=count>0?count:1;$count.html(count);modal.show();var timeid=setInterval(function(){$count.html(--count);if(count<0){modal.hide();clearInterval(timeid);cb&&cb()}},1E3);if(cb&&!modal.binded){modal.element.on("click",".J_close",cb);modal.binded=true}},iconCountdown:function(modal,message,icon_num,count,cb){var el=modal.element;var $count=el.find(".J_count");if(parseInt(icon_num)>0)el.find(".J_icon_num").text("\u8ba2\u5355\u5408\u5e76\u6210\u529f\uff0c\u5b8c\u6210\u540e\u53ef\u83b7"+
parseInt(icon_num)+"\u4e2a\u552f\u54c1\u5e01");else el.find(".J_icon_num").text("\u8ba2\u5355\u5df2\u5408\u5e76\u6210\u529f");el.find(".J_message").text(message);count=count?parseInt(count,10):parseInt($count.html(),10);count=count>0?count:1;$count.html(count);modal.show();var timeid=setInterval(function(){$count.html(--count);if(count<0){modal.hide();clearInterval(timeid);cb&&cb()}},1E3);if(cb&&!modal.binded){modal.element.on("click",".J_close",cb);modal.binded=true}},filter:function(e){var li_status=
$(e.currentTarget).find("a");var status=li_status.data("value");var $channelTab=$("#J_channel_tab");var channel=$channelTab.find(".z-current").data("value");var $container=this.$orderList.addClass("status-loading");var li_status_html=li_status.html(),li_status_title=li_status.attr("title");var params={"tabChannel":channel,"status":status};$(".order-status").find(".J_retry").closest("tr").hide().end().end().find(".empty-tips").hide();$.ajax({url:Config.getOrderListTab,data:params,timeout:5E3}).fail(function(){$container.removeClass("status-loading").addClass("status-fail");
$(".order-status").find(".J_retry").closest("tr").show().end().end().find(".empty-tips").hide()}).done(function(data){$container.removeClass("status-loading status-fail").html(data);$("#J-drop-title").attr("title",li_status_title).html(li_status_html);getSwitch.get("koubei_switch")})},pay:function(e){this.params(payAdapter,e.target);$.getJSON(payAdapter.api,payAdapter.params,$.proxy(this.renderPay,this))},merge:function(e){this.params(mergeAdapter,e.target);$.getJSON(mergeAdapter.api,mergeAdapter.params,
$.proxy(this.renderMerge,this))},doMerge:function(){var $confirmBtn=this.modalMergeConfirm.element.find(".J_ok");if($confirmBtn.hasClass("ui-btn-disable"))return;$confirmBtn.addClass("ui-btn-disable");doMergeAdapter.params.codappAccount=mergeAdapter.payType===mergeAdapter.DELIVERY_ALIPAY_POS?this.modalMerge.element.find("[type=radio]:checked").val():"";doMergeAdapter.params.codType=this.modalMerge.element.find("[type=radio]:checked").val();var subSnList=[];this.modalMerge.element.find("[name=order-sn]:checked").each(function(){subSnList.push($(this).val())});
doMergeAdapter.params.snList=subSnList.join(",");doMergeAdapter.params.codType=this.modalMerge.element.find("[type=radio]:checked").val();$.getJSON(doMergeAdapter.api,doMergeAdapter.params,$.proxy(this.renderMergeDone,this))},modify:function(orderSn){var _this=this;$.ajax({url:modifyAdapter.api,data:{ordersn:orderSn},async:false,dataType:"jsonp",jsonpCallback:"modifyOrder",success:function(data){if(_this.renderModify(data))if(data.result.relatedOrders&&data.result.relatedOrders.length)_this.orderModifyPop=
(new CommonPop({tmplId:"J_order_modify_tmpl",popConfig:{size:"large",elStyle:"modify-order-modal z-ui-dialog-in",title:"\u4fee\u6539\u8ba2\u5355\u786e\u8ba4",custom:false,button:[{type:"default",text:"\u4fee\u6539\u8ba2\u5355",size:"medium",attr:{mars_sead:""},event:function(){this.destroy();window.open(data.result.redirect)}},{type:"secondary",text:"\u53d6\u6d88",size:"medium",attr:{mars_sead:""},event:function(){this.destroy()}}],closeEvent:function(){this.destroy()}},onOpen:function(){_this.initOrderSwitch()}})).open({relatedOrders:data.result.relatedOrders});
else window.open(data.result.redirect)},error:function(){_this.renderModify({code:"500",msg:"\u5662\uff0c\u7cfb\u7edf\u73b0\u5728\u5f00\u5c0f\u5dee\u53bb\u4e86~\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002",result:{}})}})},initOrderSwitch:function(){var goodsSelector=$(".J_order_list_goods"),len=goodsSelector.length,sn="";for(var i=0;i<len;i++){sn=goodsSelector.eq(i).data("sn");$(".J_order_list_goods"+sn).Switchable({panelCls:".J_order_list_goods"+sn,pervCls:".J_order_list_goods_prev"+sn,nextCls:".J_order_list_goods_next"+
sn,effect:"slideX",firstCls:"order_btn_disabled",lastCls:"order_btn_disabled",delay:200})}$(".J_order_modify_list").perfectScrollbar("destroy");$(".J_order_modify_list").perfectScrollbar({wheelSpeed:40})},cancel:function(e){this.params(cancelAdapter,e.target);this.reviewUrl=$(e.target).parents("tbody").find(".num a").attr("href");this.orderid=$(e.target).parents("tbody").data("orderid");this.sn=$(e.target).parents("tbody").data("ordersn");var that=this;$.getJSON(cancelAdapter.api,cancelAdapter.params).done(function(data){if(that.modalCheckRelatedOrders.isShow){that.modalCheckRelatedOrders.hide();
that.modalCheckRelatedOrders.isShow=false;$(".J_cancel_after_checked").removeClass("z-ui-btn-loading")}if(data.code==555)that.confirm(that.modalWalletWarning,"",function(){var setPay=new SetPayPwd({isBg:true,hasPhoneTip:false,show:true,finish:function(){$.getJSON(cancelAdapter.api,cancelAdapter.params,$.proxy(that.renderCancel,that))}})});else that.renderCancel.call(that,data)})},checkRelatedOrders:function(e){var that=this;var popwinHtml="";var event=e;this.params(cancelAdapter,event.target);$.ajax({url:Config.getRelatedOrders,
data:{order_sn:cancelAdapter.params.ordersn},type:"get",dataType:"json",success:function(data){var orderNum=data.result.relatedOrders&&data.result.relatedOrders.length||0;var orderItem;if(data.code==200&&orderNum>0){that.isRelatedOrders=1;popwinHtml=$.Tpl("J_cancel_relative_orders_tpl",{orderList:that.processRelatedOrderData(data.result.relatedOrders)});$("#J_related_orders_content").html(popwinHtml);for(var i=0;i<orderNum;i++){orderItem=data.result.relatedOrders[i];if(orderItem.goods.length>8)that.renderOrdersSlider(orderItem.orderSn)}$("#J_orders_group_wrapper").perfectScrollbar();
that.modalCheckRelatedOrders.show();that.modalCheckRelatedOrders.isShow=true;$("#J_cancel_relative_orders_modal").off("click",".J_cancel_after_checked");$("#J_cancel_relative_orders_modal").on("click",".J_cancel_after_checked",function(e){$(this).addClass("z-ui-btn-loading");that.cancel(event)})}else that.cancel(event)},error:function(){that.cancel(event)}})},processRelatedOrderData:function(data){var orderLen=data.length,goodsLen,tmpOrder,tmpGoods,i=0,j=0;for(i=0;i<orderLen;i++){tmpOrder=data[i].goods;
goodsLen=tmpOrder.length;for(j=0;j<goodsLen;j++){tmpGoods=tmpOrder[j];if(!tmpGoods.imageUrl)tmpGoods.imageUrl="//s2.vipstatic.com/img/my/order-placeholder.png";else if(tmpGoods.imageUrl.indexOf("/")==0)tmpGoods.imageUrl=VIP_IMG_DOMAIN+tmpGoods.imageUrl;else tmpGoods.imageUrl=VIP_IMG_DOMAIN+"/"+tmpGoods.imageUrl}}return data},renderOrdersSlider:function(orderSn){var $jqContainer=$("#J_order_group_"+orderSn);$jqContainer.Switchable({panelCls:"#J_order_group_"+orderSn+" .J_slide_panels",pervCls:"#J_order_group_"+
orderSn+" .J_goods_list_prev",nextCls:"#J_order_group_"+orderSn+" .J_goods_list_next",activeCls:"z-current-panel",visiNum:1,viewNum:1,setChildWidth:530,setChildHeight:63,effect:"slideX",firstCls:"icon-btn-disable left-disabled",lastCls:"icon-btn-disable right-disabled",switchEvent:function(index,trigger,panel){}})},doCancel:function(){var el=this.modalCancel.element;var $question=el.find(".question");doCancelAdapter.params.ordersn=cancelAdapter.params.ordersn;doCancelAdapter.params.reasonChoice=el.find("[type=radio]:checked").val();
doCancelAdapter.params.reasonRemark=$question.is(":hidden")?"":$question.val();doCancelAdapter.params.is_relate=this.isRelatedOrders||0;$.getJSON(doCancelAdapter.api,doCancelAdapter.params,$.proxy(this.renderCancelDone,this))},remove:function(e){var that=this;this.confirm(this.modalConfirm,"\u786e\u5b9a\u8981\u5220\u9664\u6b64\u8ba2\u5355\u5417\uff1f",function(){that.params(removeAdapter,e.target);$.getJSON(removeAdapter.api,removeAdapter.params,$.proxy(that.renderRemove,that))})},receive:function(e){var that=
this;this.confirm(this.modalConfirm,"\u786e\u5b9a\u5df2\u6536\u5230\u5546\u54c1\u5305\u88f9\u5417\uff1f",function(){that.params(receiptAdapter,e.target);$.getJSON(receiptAdapter.api,receiptAdapter.params,$.proxy(that.renderReceive,that))})},showMore:function(e){var $curNode=$(e.currentTarget);var $moreCtr=$curNode.parents(".J_more_tr");var $moreItem=$moreCtr.siblings(".J_hide_good");var num=$moreCtr.data("num");$curNode.parents("tbody").find(".J_change_rowspan").attr("rowspan",num);$moreCtr.remove();
$moreItem.removeClass("f-hidden")},modifyPayer:function(e){var that=this;var orderSn=$(e.target).parents("tbody").data("ordersn");var html=$.Tpl("J_payer_dialog_ready_tpl",{});var dialog=$.Dialog({model:true,customStyle:true,opacity:0.5,title:"\u652f\u4ed8\u4eba\u4fe1\u606f",size:"super",content:html,closeEvent:function(){this.remove()}});dialog.open();dialog.orderSn=orderSn;var loadData=function(){$.ajax({url:Config.getPayerInfos,data:{orderSn:orderSn}}).done(function(rtn){var code=+rtn.code;var result=
rtn.result;if(code===200)that.renderPayer.call(dialog,result);else loadFail()}).fail(function(){loadFail()})};var loadFail=function(){$(".J_payer_loading").addClass("f-hidden");$(".J_payer_fail").removeClass("f-hidden");$(".J_reload_btn").off("click.reload").on("click.reload",function(){$(".J_payer_loading").removeClass("f-hidden");$(".J_payer_fail").addClass("f-hidden");loadData()})};loadData()},returnGoods:function(e){var that=this;this.params(returnAdapter,e.target);$.getJSON(returnAdapter.api,
returnAdapter.params).done(function(data){if(data.code==555)that.confirm(that.modalWalletWarning,"",function(){var setPay=new SetPayPwd({isBg:true,hasPhoneTip:false,show:true,finish:function(){$.getJSON(returnAdapter.api,returnAdapter.params,$.proxy(that.renderReturn,that))}})});else that.renderReturn.call(that,data)})},returnGoodsCancel:function(e){this.params(returnCancelAdapter,e.target);var that=this;var modal_comfire=this.modalReturnComfire;modal_comfire.show();this.modalReturnComfire.element.off("click.retrun_confirm");
this.modalReturnComfire.element.on("click.retrun_confirm",".J_retrun_confirm",function(){modal_comfire.hide();$.getJSON(returnCancelAdapter.api,returnCancelAdapter.params,$.proxy(that.renderReturnCancel,that))})},vscGoodsCancel:function(e){var that=this;var modal_comfire=this.modalVscComfire;modal_comfire.show();this.modalVscComfire.element.off("click.retrun_confirm");this.modalVscComfire.element.on("click.retrun_confirm",".J_confirm",function(){var params={orderId:$(e.target).parents("tbody").data("orderid")};
$.post(Config.cancelOrder,params).then(function(data){if(data.code===200)window.location.reload();else{modal_comfire.hide();that.alert(data.msg)}})})},vscGoodsPay:function(e){var that=this;var params={orderId:$(e.target).parents("tbody").data("orderid")};$.post(Config.vscPayCheck,params).then(function(data){if(data.code===200){window.location.href="https://pay.vip.com/vrpay/getVCashier?orderId="+$(e.target).parents("tbody").data("orderid");VIPSHOP.log("location href")}else if(data.code===501)that.countdown(that.modalCountdown,
"\u62b1\u6b49\uff0c\u60a8\u7684\u8ba2\u5355\u5df2\u88ab\u53d6\u6d88",5,function(){location.reload()});else that.verifyAlert(data.msg)})},vscVerifiy:function(e){if(!$(e.target).hasClass("ui-btn-disable")){var that=this;var params={orderId:$(e.target).parents("tbody").data("orderid")};$.post(Config.vscVerifiyUrl,params).then(function(data){if(data.code===200){$(e.target).addClass("ui-btn-disable").html('<b style="color:#f10180;">60</b>S\u540e\u53ef\u91cd\u53d1');var sec=60;var callself=function(){if(sec!==
0){$(e.target).find("b").html(sec);sec=sec-1;setTimeout(callself,1E3)}else $(e.target).html("\u53d1\u9001\u9a8c\u8bc1\u7801").removeClass("ui-btn-disable")};callself();that.verifyAlert("\u9a8c\u8bc1\u7801\u5df2\u53d1\u9001\u81f3\u8054\u7cfb\u4eba\u624b\u673a<br>\u8bf7\u6ce8\u610f\u67e5\u6536")}else if(data.code===501){$(e.target).addClass("ui-btn-disable");that.verifyAlert("\u62b1\u6b49\uff0c\u6bcf\u5929\u53ea\u80fd\u83b7\u53d63\u6b21\u9a8c\u8bc1\u7801")}else that.verifyAlert(data.msg)})}},vsccardVerifiy:function(e){if(!$(e.target).hasClass("ui-btn-disable")){var that=
this;var params={orderId:$(e.target).parents("tbody").data("orderid")};$.post(Config.vsccardVerifiyUrl,params).then(function(data){if(data.code===200){$(e.target).addClass("ui-btn-disable").html('<b style="color:#f10180;">60</b>S\u540e\u53ef\u91cd\u53d1');var sec=60;var callself=function(){if(sec!==0){$(e.target).find("b").html(sec);sec=sec-1;setTimeout(callself,1E3)}else $(e.target).html("\u53d1\u9001\u5151\u6362\u7801").removeClass("ui-btn-disable")};callself();that.verifyAlert("\u5151\u6362\u7801\u5df2\u53d1\u9001\u81f3\u8054\u7cfb\u4eba\u624b\u673a<br>\u8bf7\u6ce8\u610f\u67e5\u6536")}else if(data.code===
501){$(e.target).addClass("ui-btn-disable");that.verifyAlert("\u62b1\u6b49\uff0c\u6bcf\u5929\u53ea\u80fd\u83b7\u53d63\u6b21\u5151\u6362\u7801")}else that.verifyAlert(data.msg)})}},vsccardGoodsCancel:function(e){var that=this;var modal_comfire=this.modalVscComfire;modal_comfire.show();this.modalVscComfire.element.off("click.retrun_confirm");this.modalVscComfire.element.on("click.retrun_confirm",".J_confirm",function(){var params={orderId:$(e.target).parents("tbody").data("orderid")};$.post(Config.vsccardCancelOrder,
params).then(function(data){if(data.code===200)window.location.reload();else{modal_comfire.hide();that.alert(data.msg)}})})},vsccardGoodsPay:function(e){var that=this;var params={orderId:$(e.target).parents("tbody").data("orderid")};$.post(Config.vsccardPayCheck,params).then(function(data){if(data.code===200)window.location.href="https://pay.vip.com/vrpay/getVCashier?is_card=1&orderId="+$(e.target).parents("tbody").data("orderid");else if(data.code===501)that.countdown(that.modalCountdown,"\u62b1\u6b49\uff0c\u60a8\u7684\u8ba2\u5355\u5df2\u88ab\u53d6\u6d88",
5,function(){location.reload()});else that.verifyAlert(data.msg)})},vsccarGoodsCancel:function(e){var that=this;var modal_comfire=this.modalVscComfire;modal_comfire.show();this.modalVscComfire.element.off("click.retrun_confirm");this.modalVscComfire.element.on("click.retrun_confirm",".J_confirm",function(){var params={orderId:$(e.target).parents("tbody").data("orderid")};$.post(Config.vsccarCancelOrder,params).then(function(data){if(data.code===200)window.location.reload();else if(data.code===501)that.countdown(that.modalCountdown,
"\u62b1\u6b49\uff0c\u60a8\u7684\u8ba2\u5355\u5df2\u88ab\u53d6\u6d88",5,function(){location.reload()});else{modal_comfire.hide();that.alert(data.msg)}})})},vsccarGoodsPay:function(e){var that=this;var params={orderId:$(e.target).parents("tbody").data("orderid")};$.post(Config.vsccarPayCheck,params).then(function(data){if(data.code===200)window.location.href="https://pay.vip.com/vrpay/getVCashier?orderType=2&orderId="+$(e.target).parents("tbody").data("orderid");else if(data.code===501)that.countdown(that.modalCountdown,
"\u62b1\u6b49\uff0c\u60a8\u7684\u8ba2\u5355\u5df2\u88ab\u53d6\u6d88",5,function(){location.reload()});else that.verifyAlert(data.msg)})},vsccarUploadRemittance:function(){window.navigator.__remittanceUploadCallback=Order.uploadCallback;$(".J-vsccar-init").removeClass("z-vsccar-img");$(".J-vsccar-loading").addClass("z-vsccar-img");$(".J-vsccar-load").removeClass("z-vsccar-img");Config.iframeWindow.document.getElementById("_remittanceUploadForm_").submit()},uploadCallback:function(data){window.navigator.__remittanceUploadCallback=
null;var rs=jQuery.parseJSON(data);if(rs.code==200){if(Config.remittanceUpload.fileName){$(".u-img-name").html(Config.remittanceUpload.fileName);$(".u-img-name").css("display","inline-block")}$(".J-vsccar-init").removeClass("z-vsccar-img");$(".J-vsccar-loading").removeClass("z-vsccar-img");$(".J-vsccar-load").addClass("z-vsccar-img");$(".J-vsccar-save").removeClass("ui-btn-disable");$(".J-upload-remittance").find(".load").attr("src",rs.result)}else{var msg={4001:"\u56fe\u7247\u8d85\u8fc75M\u65e0\u6cd5\u4e0a\u4f20\uff0c\u8bf7\u538b\u7f29\u540e\u91cd\u65b0\u8bd5\u8bd5\uff01",
4002:"\u56fe\u7247\u683c\u5f0f\u4e0d\u7b26\u5408\u8981\u6c42\uff0c\u8bf7\u4e0a\u4f20GIF\u3001JPE\u3001PNG\u683c\u5f0f\u56fe\u7247\uff01"};var showMsg=msg[rs.code]?msg[rs.code]:"\u4e0a\u4f20\u5931\u8d25";alert(showMsg);$(".J-vsccar-init").addClass("z-vsccar-img");$(".J-vsccar-loading").removeClass("z-vsccar-img");$(".J-vsccar-load").removeClass("z-vsccar-img");$(".J-vsccar-save").addClass("ui-btn-disable");$(".u-img-name").html("");$(".u-img-name").css("display","none");_$file.val("")}},vsccarSaveRemittance:function(e,
target){var that=target;var url="//order.vip.com/vsccar/image/save";var data={orderId:$(e.target).parents("tbody").data("orderid")};$.post(url,data,function(rs){if(rs.code==200)that.remove();else alert("\u4fdd\u5b58\u5931\u8d25")})},remittanceDialog:function(e){Config.remittanceUpload.orderId=$(e.target).parents("tbody").data("orderid");$.Dialog({content:$("#uploadRemittanceDialog"),model:true,title:"\u4e0a\u4f20\u51ed\u8bc1",size:"medium",effect:{effect:"slide",duration:200},opacity:0.6,zIndex:1E3,
showEvent:function(){Config.iframeWindow=document.getElementById("remittance_upload_iframe").contentWindow;var that=this;that.buffObj.diaContent.parent().css("padding","10px");that.buffObj.diaContent.parent().siblings().css("font-size","12px");$(".J-vsccar-init").addClass("z-vsccar-img");that.dialogTemplates.on("click",".J-vsccar-close",function(){that.remove()}).on("click",".J-vsccar-save",function(){if($(this).hasClass("ui-btn-disable"))return;else Order.vsccarSaveRemittance(e,that)});Config.iframeWindow=
document.getElementById("remittance_upload_iframe").contentWindow;$(".J-upload-remittance").off("click").on("click",function(event){if(Config.iframeWindow.document.getElementById("orderId"))Config.iframeWindow.document.getElementById("orderId").value=Config.remittanceUpload.orderId;var _$file=$(Config.iframeWindow.document.getElementById("_remittanceUploadInputFile_"));_$file.change(function(){if(_$file.val()){var filePath=_$file.val().split("\\");if(filePath&&filePath.length){var fileName=filePath[filePath.length-
1];Config.remittanceUpload.fileName=fileName}Order.vsccarUploadRemittance()}});var targ;if(event.target)targ=event.target;else if(event.srcElement)targ=event.srcElement;if($(targ).hasClass("J-vsccar-del")){$(".J-vsccar-init").addClass("z-vsccar-img");$(".J-vsccar-loading").removeClass("z-vsccar-img");$(".J-vsccar-load").removeClass("z-vsccar-img");$(".J-vsccar-save").addClass("ui-btn-disable");$(".u-img-name").css("display","none");_$file.val("")}else _$file.click()})}}).open()},payTypeDialog:function(){$.Dialog({content:$("#payTypeDialog"),
model:true,title:"\u7ebf\u4e0b\u6c47\u6b3e",size:[760,402],effect:{effect:"slide",duration:200},opacity:0.6,zIndex:1E3,showEvent:function(){var that=this;that.buffObj.diaContent.parent().css("padding","10px");that.buffObj.diaContent.parent().siblings().css("font-size","12px");that.dialogTemplates.on("click",".J-close",function(){that.remove()})}}).open()},track:function(e){var $track=$(e.target);if($track.find(".J_track_list li").length===0){var that=this;$track.addClass("status-loading");this.params(trackAdapter,
$track);trackAdapter.params.orderSn=$track.parents("tbody").data("ordersn");$.get(trackAdapter.api,trackAdapter.params,function(res){that.renderTrack.call(that,$track,res)})}},rebuy:function(e){var $btn=$(e.target);var orderSn=$btn.closest("tbody").data("ordersn");if($btn.data("loading"))return;$btn.data("loading",1);RebuyModule.tryRebuy(orderSn).always(function(){$btn.removeData("loading")})},renderPay:function(res){var result=payAdapter.get(res);this.modalOnceMore.element.find(".J_pay_sn_tpl").each(function(){var href=
$(this).attr("href");$(this).attr("href",template(href,{sn:payAdapter.params.ordersn}))});switch(result.code){case payAdapter.DONE:case payAdapter.CANCELED:this.alert(result.msg);break;case payAdapter.ONCEMORE_DEAL:this.modalOnceMore.element.removeClass(this.onceMoreStates).addClass("has-deal");this.modalOnceMore.show();break;case payAdapter.ONCEMORE_NO_DEAL:this.modalOnceMore.element.removeClass(this.onceMoreStates).addClass("has-no-deal");this.modalOnceMore.show();break;case payAdapter.ONCEMORE_NOT_ON_DELIVERY:this.modalOnceMore.element.removeClass(this.onceMoreStates).addClass("has-no-delivery");
this.modalOnceMore.show();break;case payAdapter.SUCCESS:if(result.hasOtherType)this.modalOnceMore.element.removeClass("no-other-type");else this.modalOnceMore.element.addClass("no-other-type");if(result.fromMobile){this.modalOnceMore.element.find(".ui-btn2").attr("href",result.otherPayUrl);this.modalOnceMore.element.addClass("from-mobile")}else this.modalOnceMore.element.removeClass("from-mobile");if(result.cashAble){this.modalOnceMore.element.find("#other-type-link").addClass("u-order-pay");this.modalOnceMore.element.removeClass("has-no-delivery")}else{this.modalOnceMore.element.find("#other-type-link").removeClass("u-order-pay");
this.modalOnceMore.element.addClass("has-no-delivery")}if(result.hasDeal)this.modalOnceMore.element.addClass("has-deal").removeClass("has-no-deal");else this.modalOnceMore.element.addClass("has-no-deal").removeClass("has-deal");if(result.otherPayUrl)this.modalOnceMore.element.find("#other-type-link a").attr("href",result.otherPayUrl);if(result.mobilePayResult)this.modalOnceMore.element.removeClass("cash-only");else this.modalOnceMore.element.addClass("cash-only");this.modalOnceMore.show();break;case payAdapter.MOBILE_ONLY:this.modalOnceMoreMobileOnly.show();
break;case payAdapter.NO_STOCK:this.modalNoStock.show();break;case payAdapter.PART_IN_STOCK:var noStockList=result.noStockList;var stockList=result.stockList;var $tbody=this.modalPartInStock.element.find("tbody").empty();var i,item,html=[];for(i=noStockList.length;i--;){item=noStockList[i];item.stateClass=item.amount>0?"status-remain":"status-sold";html.push(template(this.payStockTpl,item))}for(i=stockList.length;i--;){item=stockList[i];item.stateClass=item.amount<item.goodsCount?"status-remain":
"status-normal";html.push(template(this.payStockTpl,item))}$tbody.html(html.join(""));this.modalPartInStock.element.find(".J_rebuy_stock").data("callback",result.callback).attr("href",result.redirect);this.modalPartInStock.show();break;default:this.alert(result.msg)}},renderMerge:function(res){var result=mergeAdapter.get(res);switch(result.code){case mergeAdapter.CANCELED:case mergeAdapter.REFUSED:this.alert(result.msg);break;case mergeAdapter.EMPTY:this.modalMergeEmpty.show();break;case mergeAdapter.OK:var $tbody=
this.modalMerge.element.find("tbody").empty();var item=result.main;item.money=+item.money+ +item.surplus+ +item.virtual_money;if(!/\.\d+/.test(item.money))item.money+=".00";var $row=$(template(this.mergeRowTpl,item));$row.find("[type=checkbox]").attr("checked","checked").attr("disabled","disabled").attr("name","main-order-sn");$row.children("td").eq(1).append('<p class="gray">\u4e3b\u8ba2\u5355</p>');$tbody.append($row);doMergeAdapter.params.mainSn=item.order_sn;doMergeAdapter.params.codType=mergeAdapter.payType;
var i;for(i=result.orders.length;i--;){item=result.orders[i];item.money=+item.money+ +item.surplus+ +item.virtual_money;if(!/\.\d+/.test(item.money))item.money+=".00";$row=$(template(this.mergeRowTpl,item));$tbody.append($row)}var el=this.modalMerge.element.removeClass(this.payTypeStates.all);var typeState=this.payTypeStates[result.payType];if(typeState)el.addClass(typeState);var alipayList=result.alipayList;this.modalMerge.element.find(".m-pay").find("[name=pay-kind]").eq(0).prop("checked",true);
var $alipayList=this.modalMerge.element.find(".J_alipay_list").empty();var $mPay=this.modalMerge.element.find(".m-pay");$mPay.find("[type=radio]").on("click",function(evt){var $tar=$(evt.target);if($tar.prop("name")==="pay-kind")if($tar.prop("id")==="alipay")$mPay.find("[name=alipay-kind]").eq(0).prop("checked",true);else $mPay.find("[name=alipay-kind]").prop("checked",false)});for(i=0;i<alipayList.length;i++){$row=$(template(i===0?this.mergeAlipayFirstTpl:this.mergeAlipayTpl,alipayList[i]));$alipayList.append($row);
$alipayList.show();$row.on("click",function(evt){var $tar=$(evt.target);$mPay.find("[id=alipay]").prop("checked",true)})}this.modalMerge.show();break;default:this.alert(result.msg)}},renderMergeDone:function(res){this.modalMerge.hide();this.modalMergeConfirm.hide();var result=doMergeAdapter.get(res);switch(result.code){case doMergeAdapter.SUCCESS:if(result.msg)this.iconCountdown(this.modalMergeSuccessWithMessage,result.msg,res.point,5,function(){location.reload()});else{var J_iconNum_txt;if(parseInt(res.point)>
0)J_iconNum_txt="\u8ba2\u5355\u5408\u5e76\u6210\u529f\uff0c\u5b8c\u6210\u540e\u53ef\u83b7"+parseInt(res.point)+"\u4e2a\u552f\u54c1\u5e01";else J_iconNum_txt="\u8ba2\u5355\u5df2\u5408\u5e76\u6210\u529f";this.countdown(this.modalMergeSuccess,J_iconNum_txt,5,function(){location.reload()})}break;case doMergeAdapter.FEFUN_FAIL:this.confirm(this.modalMergePaybackFail,result.msg,function(){location.reload()});this.modalMergePaybackFail.element.on("click",".J_close",function(){location.reload()});break;default:this.alert(result.msg)}},
renderModify:function(res){var result=modifyAdapter.get(res);var isOK=false;switch(result.code){case modifyAdapter.CANCELED:case modifyAdapter.DISABLED:this.alert(result.msg);break;case modifyAdapter.OK:isOK=true;break;default:this.alert(result.msg);break}return isOK},renderCancel:function(res){var result=cancelAdapter.get(res);var that=this;switch(result.code){case cancelAdapter.CANCELED:case cancelAdapter.DISABLED:this.alert(result.msg);break;case cancelAdapter.OK:this.modalCancel.show();if(result.storeSource==
1&&result.tips)this.modalCancel.element.find("#J_cancel_tips").html(result.tips);this.modalCancel.element.find(".J_review").attr("href",this.reviewUrl);var $modifyLink=this.modalCancel.element.find(".J_modify_link");$modifyLink.each(function(){var href=$(this).attr("href");$(this).attr("href",template(href,{orderid:that.orderid,sn:that.sn}))});break;default:this.alert(result.msg)}},renderCancelDone:function(res){var result=doCancelAdapter.get(res);this.modalCancel.hide();this.modalCancel.element.find("[type=radio]").prop("checked",
false).end().find("[name=any-question]").hide();if(result.result&&result.result.storeSource==1){if(result.code){this.modalCancelSuccess.element.find("#J_cancel_success").hide();var return_type_text="";this.countdown(this.modalCancelSuccess,return_type_text,5,function(){location.reload()});if(result.msg)this.modalCancelSuccess.element.find(".J_message").html(result.msg);else this.modalCancelSuccess.element.find(".info").hide();this.modalCancelSuccess.element.find(".coupon_notice").hide();this.modalCancelSuccess.element.find(".cancel_message").hide()}switch(result.code){case doCancelAdapter.SUCCESS:this.modalCancelSuccess.element.find("#J_cancel_success_mp").show();
break;default:this.modalCancelSuccess.element.find("#J_cancel_fail_mp").show()}}else switch(result.code){case doCancelAdapter.SUCCESS:var return_type_text="";if(result.result&&result.result.return_type)switch(parseInt(result.result.return_type)){case 2:return_type_text="\u53d6\u6d88\u8ba2\u5355\u540e\uff0c\u94b1\u6b3e\u5c06\u6309\u7167\u60a8\u9ed8\u8ba4\u7684\u9000\u6b3e\u8def\u5f84 \u9000\u56de\u96f6\u94b1";break;case 1:return_type_text="\u53d6\u6d88\u8ba2\u5355\u540e\uff0c\u94b1\u6b3e\u5c06\u6309\u7167\u60a8\u9ed8\u8ba4\u7684\u9000\u6b3e\u8def\u5f84 \u539f\u8def\u9000\u56de";
break;default:return_type_text=""}this.countdown(this.modalCancelSuccess,return_type_text,5,function(){location.reload()});this.modalCancelSuccess.element.find(".info").toggle(!!$.trim(return_type_text));if(result.result&&result.result.pms_flag==0)this.modalCancelSuccess.element.find(".coupon_notice").html("\u5f53\u524d\u4f7f\u7528\u7684\u793c\u5238\u8fd8\u6709\u5176\u5b83\u8ba2\u5355\u4eab\u53d7\u4f18\u60e0\uff0c\u6682\u4e0d\u9000\u56de");break;default:this.alert(result.msg)}},renderRemove:function(res){var result=
removeAdapter.get(res);switch(result.code){case removeAdapter.SUCCESS:this.countdown(this.modalCountdown,res.msg,5,function(){location.reload()});break;default:this.alert(result.msg)}},renderReturn:function(res){var result=returnAdapter.get(res);switch(result.code){case returnAdapter.REFUSED:case returnAdapter.REPEAT:this.alert(result.msg);break;case returnAdapter.SUCCESS:location.href=result.redirect;break;default:this.alert(result.msg)}},renderReturnCancel:function(res){var result=returnCancelAdapter.get(res);
switch(result.code){case returnCancelAdapter.CANCELED:case returnCancelAdapter.DISABLED:this.alert(result.msg);break;case returnCancelAdapter.SUCCESS:this.countdown(this.modalCountdown,"\u8ba2\u5355\u5df2\u6210\u529f\u53d6\u6d88\u9000\u8d27",5,function(){location.reload()});break;default:this.alert(result.msg)}},renderTrack:function($track,res){var result=trackAdapter.get(res);var $list=$track.find(".J_track_list");$track.removeClass("status-loading");switch(result.code){case trackAdapter.SUCCESS:var list=
result.list;var $ul=$("<ul/>");var i;for(i=0;i<list.length;i++){var item=list[i];$ul.append($("<li/>").append('<span class="time">'+item.time+"</span>").append('<span class="info">'+item.remark+"</span>"))}$track.removeClass("status-fail");$list.empty().append($ul);break;default:$track.addClass("status-fail")}},renderReceive:function(res){var result=receiptAdapter.get(res);switch(result.code){case receiptAdapter.OK:location.reload();break;default:this.alert(result.msg)}},renderPayer:function(res){var orderPayer=
res.orderPayer?res.orderPayer:{};var validPayers=res.validPayers?res.validPayers:[];var payerNotice=res.haitaoPayerNotice?res.haitaoPayerNotice:"";var dialog=this;var html=$.Tpl("J_modify_payer_tpl",{payerNotice:payerNotice,orderPayer:orderPayer,validPayers:validPayers});dialog.content(html).resize();var MAX_PAYER_DOM_HEIGHT=250;var showScrollbar=function(maxHeight){var $payerList=$(".J_payer_list");var height=$payerList.height();if(height>=maxHeight){$payerList.perfectScrollbar("destroy");$payerList.perfectScrollbar({wheelSpeed:20,
wheelPropagation:false,swipePropagation:false,suppressScrollX:true});$payerList.perfectScrollbar("update")}};showScrollbar(MAX_PAYER_DOM_HEIGHT);$("input[name=payer]").change(function(){$(".J_payer_submit").removeClass("ui-btn-disable");var $this=$(this);var isShowForm=!$(".J_payer_form").hasClass("f-hidden");var payerLength=$(".J_payer_list .item").length*37;var scrollLength=0;if($(this).val()==="add"&&!isShowForm){$(".J_payer_form").removeClass("f-hidden");scrollLength=payerLength}else if(isShowForm){$(".J_payer_form").addClass("f-hidden");
scrollLength=payerLength-MAX_PAYER_DOM_HEIGHT;var curScrollLength=$(".J_payer_list").scrollTop();if(scrollLength>curScrollLength)scrollLength=curScrollLength}if(scrollLength)$(".J_payer_list").perfectScrollbar("update").scrollTop(scrollLength)});Order.modifyPayerEvent(dialog,validPayers)},modifyPayerEvent:function(formDialog,validPayers){var verifyPayer=function(){var $name=$(".J_payer_name_input");var $idCard=$(".J_payer_idCard_input");var verifyName=function(value){var result={valid:false,msg:""};
if(value==""||value=="\u8bf7\u8f93\u5165\u652f\u4ed8\u4eba\u59d3\u540d")result.msg="\u8bf7\u8f93\u5165\u652f\u4ed8\u4eba\u59d3\u540d";else{var chineseReg=/^[\u4e00-\u9fa5\u00b7]+$/;if(!chineseReg.test(value))result.msg="\u652f\u4ed8\u4eba\u59d3\u540d\u53ea\u652f\u6301\u4e2d\u6587";else if(value.length>16)result.msg="\u6700\u5927\u957f\u5ea6\u4e3a16\u4e2a\u5b57\u7b26";else result.valid=true}return result};var validateCartIdFormat=function(value){var result={valid:false,msg:""};if(value==""||value==
"\u8bf7\u8f93\u5165\u652f\u4ed8\u4eba\u8eab\u4efd\u8bc1\u53f7\u7801")result.msg="\u8bf7\u8f93\u516518\u4f4d\u8eab\u4efd\u8bc1\u53f7\u7801";else if(value.length!=18)result.msg="\u8bf7\u8f93\u516518\u4f4d\u8eab\u4efd\u8bc1\u53f7\u7801";else{var tmpArr=value.split("");var sum=0;for(var i=0,iMax=tmpArr.length-1;i<iMax;i++){var item=tmpArr[i];sum+=item*Config.idCardVerify.weight[i]}if(!(Config.idCardVerify.modMap[sum%11]==tmpArr[iMax]))result.msg="\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u8eab\u4efd\u8bc1\u53f7\u7801";
else result.valid=true}return result};var nameBlur=function(){var name=$.trim($name.val()).replace(/(\u3002|\uff0e|\.)/g,"\u00b7");$name.val(name);var result=verifyName(name);if(!result.valid&&result.msg){$(".J_payer_name_group").addClass("z-ui-form-item-warning z-ui-tooltips-in").find(".J_error_text").text(result.msg);return false}else{$(".J_payer_name_group").removeClass("z-ui-form-item-warning z-ui-tooltips-in");return true}};var cardBlur=function(){$(".J_idNum_big_tooltips").addClass("f-hidden");
var idCard=$.trim($idCard.val()).toUpperCase();$idCard.val(idCard);var result=validateCartIdFormat(idCard);if(!result.valid&&result.msg){$(".J_payer_idCard_group").addClass("z-ui-form-item-warning z-ui-tooltips-in").find(".J_error_text").text(result.msg);return false}else{$(".J_payer_idCard_group").removeClass("z-ui-form-item-warning z-ui-tooltips-in");return true}};return{nameBlur:nameBlur,cardBlur:cardBlur}}();$(".J_payer_name_input").on("blur",function(){verifyPayer.nameBlur()}).on("focus",function(){$(".J_payer_name_group").removeClass("z-ui-form-item-warning z-ui-tooltips-in")});
$(".J_payer_idCard_input").on("blur",function(){verifyPayer.cardBlur()}).on("focus",function(){$(".J_payer_idCard_group").removeClass("z-ui-form-item-warning z-ui-tooltips-in")}).on("keyup focus",function(){var idCard=$.trim($(this).val());if(idCard){$(".J_idNum_big").text(idCard);$(".J_idNum_big_tooltips").removeClass("f-hidden")}else $(".J_idNum_big_tooltips").addClass("f-hidden")});$(".J_idCard_tip").hover(function(){$(".J_idCard_tooltips").removeClass("f-hidden").addClass("z-ui-tooltips-in")},
function(){$(".J_idCard_tooltips").addClass("f-hidden").removeClass("z-ui-tooltips-in")});var showToast=function(state,msg){$(".J_order_tips").removeClass("f-hidden").find(".J_tip").removeClass("z-ui-tooltips-in");switch(state){case "success":$(".J_order_tips").find(".J_success").addClass("z-ui-tooltips-in").find(".J_text").text(msg);break;case "fail":$(".J_order_tips").find(".J_fail").addClass("z-ui-tooltips-in").find(".J_text").text(msg);break}setTimeout(function(){$(".J_order_tips").addClass("f-hidden")},
3E3)};var showErrorDialog=function(title,content){var html=$.Tpl("J_payer_error",{title:title,content:content});$.Dialog({model:true,opacity:0.5,title:"",size:"small",content:html,button:[{type:"primary",text:"\u786e\u5b9a",size:"medium",event:function(){this.remove()}},{type:"default",text:"\u53d6\u6d88",size:"medium",event:function(){this.remove()}}]}).open()};var showFormTip=function($item,msg){$item.addClass("z-ui-form-item-warning z-ui-tooltips-in").find(".J_error_text").text(msg)};var submitData=
function(){var isBtnDisable=$(".J_payer_submit").hasClass("ui-btn-disable");var isLoading=$(".J_payer_submit").hasClass("z-ui-btn-loading");if(!isBtnDisable&&!isLoading){var hasSelOpt=$("input[name=payer]").length>0;var selectId=$("input[name=payer]:checked").val();if(hasSelOpt&&!selectId){$(".J_payer_submit").addClass("ui-btn-disable");return false}var data={};data.orderSn=formDialog.orderSn;if(selectId==="add"||!hasSelOpt){var checkName=verifyPayer.nameBlur();var checkIdCard=verifyPayer.cardBlur();
if(checkName&&checkIdCard){data.payer=$(".J_payer_name_input").val();data.payerIdCardNo=$(".J_payer_idCard_input").val()}}else{var selPayer=validPayers[selectId];if(selPayer){data.payer=selPayer.payer;data.payerIdCardNo=selPayer.payerIdCardNo}else VIPSHOP.log("sel payer error:"+selectId)}if(data.orderSn&&(data.payer&&data.payerIdCardNo)){$(".J_payer_submit").addClass("z-ui-btn-loading");$.post(Config.updateOrderPayer,data).then(function(data){$(".J_payer_submit").removeClass("z-ui-btn-loading");var code=
+data.code;switch(code){case 200:formDialog.remove();showToast("success","\u4fee\u6539\u6210\u529f");setTimeout(function(){document.location.reload()},3E3);break;case 2E3:showFormTip($(".J_payer_name_group"),"\u8bf7\u8f93\u5165\u652f\u4ed8\u4eba\u59d3\u540d");break;case 2001:showFormTip($(".J_payer_idCard_group"),"\u8bf7\u8f93\u516518\u4f4d\u8eab\u4efd\u8bc1\u53f7\u7801");break;case 2002:var count=data.result.remain_count;var msg="\u672a\u901a\u8fc7\u9a8c\u8bc1\u8bf7\u6838\u5b9e\u8eab\u4efd\u8bc1\u53f7\u7801\u4e0e\u59d3\u540d\u662f\u5426\u5339\u914d";
if(count)msg="\u8bf7\u6838\u5b9e\u8eab\u4efd\u8bc1\u53f7\u7801\u4e0e\u59d3\u540d\u662f\u5426\u5339\u914d\uff0c\u4eca\u5929\u4ec5\u5269"+count+"\u6b21\u673a\u4f1a\u54e6";showFormTip($(".J_payer_idCard_group"),msg);break;case 2003:formDialog.remove();showErrorDialog("\u672a\u901a\u8fc7\u9a8c\u8bc1","\u4f60\u4eca\u5929\u5df2\u7528\u5b8c\u4e86\u9a8c\u8bc1\u673a\u4f1a\uff0c\u8d2d\u4e70\u6d77\u5916\u7cbe\u54c1\u6682\u672a\u6210\u529f\uff0c\u5efa\u8bae\u4f7f\u7528\u5176\u4ed6\u652f\u4ed8\u8d26\u6237\uff0c\u91cd\u65b0\u9009\u8d2d\u3002");
break;default:formDialog.remove();showErrorDialog("\u62a2\u8d2d\u9ad8\u5cf0\uff0c\u7f51\u7edc\u7e41\u5fd9\uff0c\u8bf7\u8fd4\u56de\u91cd\u8bd5");break}},function(){$(".J_payer_submit").removeClass("z-ui-btn-loading");formDialog.remove();showErrorDialog("\u62a2\u8d2d\u9ad8\u5cf0\uff0c\u7f51\u7edc\u7e41\u5fd9\uff0c\u8bf7\u8fd4\u56de\u91cd\u8bd5")})}}};$(".J_payer_submit").off("click.submit").on("click.submit",function(){submitData()});$(".J_payer_cancel").off("click.cancel").on("click.cancel",function(){formDialog.remove()})}};
var Guide={init:function(){this.disabled=$.Cookie.get("isGuideDisabled");if(this.disabled)return;this.maskZindex=1040;this.step=0;this.stepModals=[new Modal({element:"#J_new_guide_step1",centered:false}),new Modal({element:"#J_new_guide_step2",centered:false})];this.show();var $guides=$(),i;for(i=this.stepModals.length;i--;)$guides=$guides.add(this.stepModals[i].element);$guides.on("click",".close",$.proxy(this.close,this)).on("click",".next",$.proxy(this.next,this))},show:function(step){this.step=
typeof step==="number"?step:this.step;var stepModal=this.stepModals[this.step];stepModal.element.css("z-index",this.maskZindex+1);stepModal.show()},close:function(){this.stepModals[this.step].hide();$.Cookie.set("isGuideDisabled",1,"","/",24*365);$(".J_declare").show()},next:function(){var next=this.step+1;this.close(this.step);if(next<this.stepModals.length){this.show(next);$(".J_declare").show()}}};var afterInited=function(){var searchParts=location.hash.replace("#","").split("&");var mMap={};for(var i=
0;i<searchParts.length;i++){var pair=searchParts[i].split("=");mMap[pair[0]]=pair[1]}var $orderItem=$("[data-ordersn="+mMap.ordersn+"]");if(mMap.act==="codCheck")$orderItem.find(".J_pay").trigger("click");else if(mMap.act==="saleAgo")$orderItem.find(".J_saleago").trigger("click");else if(mMap.act==="rebuy")$orderItem.find(".J_rebuy").trigger("click")};var OrderSearch={params:{"tabChannel":"all","status":"0","pageNo":1},$cnt:null,LOCAL_STORAGE_KEY:"order_search_history",cacheData:null,MAX_LENGTH:6,
PLACEHOLDER_TEXT:null,init:function(){this.$cnt=$("#J_order_search_box");if(this.$cnt.length){this._initParams();if(this.params.tabChannel==="all"){this.$cnt.show();this._initData();this._initEvent()}}},fallbackParam:function(){var url=$.Cookie.get("vipshop_passport_src");if(url&&/(?:&|\?)searchKey=(.*)$/.test(url))return RegExp.$1;return null},_initData:function(){this.cacheData=$.Storage.get(this.LOCAL_STORAGE_KEY)||[];var initVal=this.params.searchKey;if(!VIPSHOP.Detect.placeholder){this.PLACEHOLDER_TEXT=
this.$cnt.find(".search-input").attr("placeholder");if(!initVal)initVal=this.PLACEHOLDER_TEXT}this.$cnt.find(".search-input").val(initVal)},_initParams:function(){var search=document.location.search;var idx=null,_this=this;if(search)$.each(search.substr(1).split("&"),function(i,item){idx=item.indexOf("=");try{_this.params[item.substr(0,idx)]=decodeURIComponent(item.substr(idx+1))}catch(e){_this.params[item.substr(0,idx)]=_this.fallbackParam()||item.substr(idx+1)}})},_displayHistory:function(data){data=
data||this.cacheData;var _html="";if(data&&data.length){$.each(data,function(i,item){_html+='<dd class="item">'+item+"</item>"});this.$cnt.find(".J_search_list").html(_html).closest(".J_search_history").show()}},_updateHistory:function(val){var idx=$.inArray(val,this.cacheData);if(idx!==-1)this.cacheData.splice(idx,1);this.cacheData.unshift(val);if(this.cacheData.length>this.MAX_LENGTH)this.cacheData.length=this.MAX_LENGTH;$.Storage.set(this.LOCAL_STORAGE_KEY,this.cacheData)},_checkValid:function(){var val=
$.trim(this.$cnt.find(".search-input").val());if(!val||!VIPSHOP.Detect.placeholder&&val===this.PLACEHOLDER_TEXT)return false;return val},_doSearch:function(val){this._updateHistory(val);var url="/order/orderlist?";this.params["searchKey"]=val;this.params["pageNo"]=1;for(var p in this.params){url+=p+"="+encodeURIComponent(this.params[p]);url+="&"}document.location.href=url.replace(/&$/,"")},_initEvent:function(){var _this=this;$(document).on("click",function(e){if(!$(e.target).hasClass("search-input")&&
!$(e.target).hasClass("search-btn")){_this.$cnt.find(".J_search_history").hide();_this.$cnt.find(".J_search_field").removeClass("z-ui-tooltips-in")}});this.$cnt.on("click",".J_clear_history",function(){_this.$cnt.find(".J_search_history").hide().find(".J_search_list").empty();$.Storage.remove(_this.LOCAL_STORAGE_KEY);_this.cacheData=[]}).on("click",".J_search_list > .item",function(){var val=$(this).text();_this.$cnt.find(".search-input").val(val);_this.$cnt.find(".search-btn").click()}).on("click",
".search-input",function(e){var val=$.trim($(this).val());if(!val)_this._displayHistory()}).on("keyup",".search-input",function(e){var val=$.trim($(this).val());if(!val)_this._displayHistory();else{_this.$cnt.find(".J_search_history").hide();if(e.keyCode!==13)_this.$cnt.find(".J_search_field").removeClass("z-ui-tooltips-in");else{_this.$cnt.find(".search-input").val(val);_this.$cnt.find(".search-btn").click()}}}).on("click",".search-btn",function(e){var val=_this._checkValid();if(!val)_this.$cnt.find(".J_search_field").addClass("z-ui-tooltips-in");
else _this._doSearch(val)}).on("submit","form",function(e){e.preventDefault();return false});if(!VIPSHOP.Detect.placeholder)this.$cnt.on("focusout",".search-input",function(){var val=$.trim($(this).val());if(!val)$(this).val(_this.PLACEHOLDER_TEXT)}).on("focusin",".search-input",function(){var val=$(this).val();if(val===_this.PLACEHOLDER_TEXT){$(this).val("");_this._displayHistory()}})}};$(function(){Order.init();afterInited();OrderSearch.init();var addArray;if(location.href.match("returnlist"))addArray=
["ADS5LAA8","ADSL6SNX","ADS4DPM2"];else addArray=["ADS5LAA8","ADSL6SNX","ADS4DPM2"];Ads.init(addArray).fetch(function(){var $ads=$("#J_adads5laa8");if($ads.children().length<=1)return;else $ads.show();var sec=0,slildeSet;var slide=function(){$ads.children().eq(sec++%$ads.children().length).show().siblings().hide();slildeSet=setTimeout(slide,3E3)};slide();$ads.hover(function(){clearTimeout(slildeSet)},function(){slildeSet=setTimeout(slide,3E3)})});window.Order=Order;$(document).on("click",function(evt){var $src=
$(evt.target||event.srcElement);if($src.closest("#J_dropdown_filter").length>0||$src.attr("id")==="J_dropdown_filter")return;if($("#J_dropdown_filter").hasClass("u-select-active"))$("#J_dropdown_filter").removeClass("u-select-active")})})},{"../../bo/switch/index.js":1,"../../plugins/modules/ui/modules/CommonPop":27,"./modules/ads":4,"./modules/afterSalePop":5,"./modules/exchangePop":6,"./modules/jquery.form":7,"./modules/list/cancel-adapter":8,"./modules/list/do-cancel-adapter":9,"./modules/list/do-merge-adapter":10,
"./modules/list/merge-adapter":11,"./modules/list/modify-adapter":12,"./modules/list/pay-adapter":13,"./modules/list/receipt-adapter":14,"./modules/list/remove-adapter":15,"./modules/list/return-adapter":16,"./modules/list/return-cancel-adapter":17,"./modules/list/template":18,"./modules/list/track-adapter":19,"./modules/modal":20,"./modules/rebuy":21}],4:[function(require,module,exports){var template=require("./template");module.exports={api:"//pcapi.vip.com/cmc/index.php?callback=?",init:function(ids){this.ids=
ids;return this},fetch:function(cb){var that=this;$.getJSON(this.api,{type:this.ids.join(","),channelId:"",warehouse:""},function(res){that.render(res,cb)})},render:function(res,cb){for(var k in res){var items=res[k].items,i,len=items.length,slotName=k.toLowerCase(),$slot=$("#J_"+slotName).empty(),adTpl=$("#J_"+slotName+"_tpl").html()||$("#J_ad_tpl").html();for(i=0;i<len;i++){var item=items[i];var $item=$(template(adTpl,item));if(!item.link)if($item.is("a"))$item.removeAttr("href");else $item.find("a").removeAttr("href");
else if(item.blank)if($item.is("a"))$item.attr("target","_blank");else $item.find("a").attr("target","_blank");$slot.append($item)}}if(cb&&typeof cb==="function")cb()}}},{"./template":22}],5:[function(require,module,exports){var afterSalePop={checkOrders:function($orderList){var that=this,$btns=$orderList.find(".J_afterSale_btn");this.btns=$btns;for(var i=0;i<$btns.length;i++){var orderSn=$($btns[i]).data("ordersn"),afterSaleType=$($btns[i]).data("aftersaletype"),ruturnApplyCount=$($btns[i]).data("ruturnapplycount"),
xchApplyCount=$($btns[i]).data("xchapplycount");if(afterSaleType===1&&ruturnApplyCount>0)$($btns[i]).removeClass("f-hidden");else if(afterSaleType===3&&xchApplyCount>0)$($btns[i]).removeClass("f-hidden");if(ruturnApplyCount>1)$($btns[i]).find(".returnDown").removeClass("f-hidden");else if(xchApplyCount>1)$($btns[i]).find(".exchangeDown").removeClass("f-hidden")}that._afterRender($orderList)},_getData:function(orderSn,afterSaleType){var data={orderSn:orderSn,afterSaleType:afterSaleType};return $.ajax({url:"//order.vip.com/afterSaleList/info",
type:"GET",data:data})},_render:function(rtn,$aftersalePop){if(rtn&&rtn.code=="200"){var result=rtn.result||{};if(result.listCount>0){var listData=rtn.result&&rtn.result.afterSaleListVOs||[];var summary=result.afterSaleListVOs&&result.afterSaleListVOs[0].summaryVO||{};afterSaleType=summary.afterSaleType;var orderList=[];for(var i=0;i<listData.length;i++){var item={};item.summary=listData[i].summaryVO||{};item.goods=listData[i].afterSaleGoodVOs||[];item.goods=item.goods.length?[item.goods[0]]:[];var typeName,
styleName,goodsBackWay=+item.summary.goodsBackWay;if(afterSaleType===1){styleName="f-return";if(goodsBackWay===0)typeName="\u81ea\u5bc4\u9000\u8d27";else if(goodsBackWay===2)typeName="\u4e0a\u95e8\u63fd\u9000"}else if(afterSaleType===3){styleName="f-exchange";if(goodsBackWay===0)typeName="\u81ea\u5bc4\u6362\u8d27";else if(goodsBackWay===1)typeName="\u4e0a\u95e8\u6362\u8d27"}for(var j=0;j<item.goods;j++)item.goods[j].goodsUrl=item.goods[j].goodsUrl||"javascript:void(0);";item.summary.typeName=typeName;
item.summary.styleName=styleName;orderList.push(item)}var html=$.Tpl("J_aftersale_pop_tpl",{orderList:orderList});var type="";if(afterSaleType===1)type="return";else if(afterSaleType===3)type="exchange";else return false;$($aftersalePop).html(html)}}},_afterRender:function($orderList){var that=this;var $btns=this.btns;this.btns.on("click",function(e){var $target=$(e.target),afterSaleType=$target.parents(".J_afterSale").find(".J_afterSale_btn").data("aftersaletype"),orderSn=$target.parents(".J_afterSale").find(".J_afterSale_btn").data("ordersn"),
ruturnApplyCount=$target.parents(".J_afterSale").find(".J_afterSale_btn").data("ruturnapplycount"),xchApplyCount=$target.parents(".J_afterSale").find(".J_afterSale_btn").data("xchapplycount"),fistRuturnApplyId=$target.parents(".J_afterSale").find(".J_afterSale_btn").data("fistruturnapplyid"),fistXchApplyId=$target.parents(".J_afterSale").find(".J_afterSale_btn").data("fistxchapplyid"),count=afterSaleType===1?ruturnApplyCount:xchApplyCount,applyId=afterSaleType===1?fistRuturnApplyId:fistXchApplyId;
if(count===1)window.open("//order.vip.com/afterSaleDetail/index?applyId="+applyId+"&afterSaleType="+afterSaleType+"&orderSn="+orderSn);else if(count>1){if(ruturnApplyCount>1){$target.find(".returnDown").toggleClass("f-hidden");$target.find(".returnUp").toggleClass("f-hidden")}else if(xchApplyCount>1){$target.find(".exchangeDown").toggleClass("f-hidden");$target.find(".exchangeUp").toggleClass("f-hidden")}var type="";if(afterSaleType===1)type="return";else if(afterSaleType===3)type="exchange";else return false;
var $aftersalePop=$target.parents(".J_change_rowspan").find(".J_aftersale_"+type+"_pop_block"),$pop=$aftersalePop.find(".J_aftersale_pop");if($pop.length>0)$pop.toggleClass("z-ui-tooltips-in");else(function(){that._getData(orderSn,afterSaleType).done(function(rtn){that._render(rtn,$aftersalePop);$aftersalePop.find(".J_aftersale_pop").css({top:$target.parents(".J_afterSale").find(".J_afterSale_btn").position().top+20,left:$target.parents(".J_afterSale").find(".J_afterSale_btn").position().left-566});
$aftersalePop.on("click",".J_show_more",function(e){var $curNode=$(e.currentTarget);var $moreCtr=$curNode.parents(".J_more_tr");var $moreItem=$moreCtr.siblings(".J_hide_good");var num=$moreCtr.data("num");$curNode.parents("tbody").find(".J_change_rowspan").attr("rowspan",num);setTimeout(function(){$moreCtr.remove()},100);$moreItem.removeClass("f-hidden")})})})()}})}};$(function(){if(!VIPSHOP.isIE6&&!$.fn.perfectScrollbar)$.Loader.advScript({name:"scrollbar",url:(VIPSHOP.s2StaticJs||VIPSHOP.staticJs)+
"/plugins/perfect-scrollbar-0.4.8.with-mousewheel.min.js?"+VIPSHOP.jsVer})});module.exports=afterSalePop},{}],6:[function(require,module,exports){var exchangePop={checkOrders:function($orderList){var that=this,$btns=$orderList.find(".J_ex_btn");this.btns=$btns;for(var i=0;i<$btns.length;i++){that.orderSnList=[];var exchangeNewOrderSnList=$($btns[i]).data("exchangenewordersnlist");if(exchangeNewOrderSnList.length>0){$($btns[i]).parents(".J_exchange").removeClass("f-hidden");$($btns[i]).parents(".J_exchange").find(".J_ex-tips").html("\u5f53\u524d\u8ba2\u5355\u6709"+
exchangeNewOrderSnList.length+"\u4e2a\u6362\u8d27\u65b0\u8ba2\u5355")}if(exchangeNewOrderSnList.length>1)$($btns[i]).find(".exchangeDown").removeClass("f-hidden")}that._afterRender($orderList)},_getData:function(exchangeNewOrderSnList){var data={orderSnList:exchangeNewOrderSnList};return $.ajax({url:"//order.vip.com/orderList/getListByExNewOrderSn",type:"GET",data:data})},_render:function(rtn,$aftersalePop){if(rtn&&(rtn.code=="200"&&(rtn.result&&rtn.result.orderList))){var orderList=rtn.result.orderList||
[];var num=orderList.length;var html=$.Tpl("J_exchange_pop_tpl",{orderList:orderList,num:num});$($aftersalePop).html(html)}},_afterRender:function($orderList){var that=this;var $btns=this.btns;$orderList.on("click",".J_ex_btn, .J_arrow",function(e){console.log($(e.target));var $target=$(e.target),exchangeNewOrderSnList=$target.parents(".J_exchange").find(".J_ex_btn").data("exchangenewordersnlist"),newOrderSnList="";if(exchangeNewOrderSnList&&exchangeNewOrderSnList.length==1)window.open("//order.vip.com/multDetail/order/index?orderClient=pc&orderSn="+
exchangeNewOrderSnList[0]);else if(exchangeNewOrderSnList&&exchangeNewOrderSnList.length>1){$target.parents(".J_exchange").find(".exchangeDown").toggleClass("f-hidden");$target.parents(".J_exchange").find(".exchangeUp").toggleClass("f-hidden");var $aftersalePop=$(".J_aftersale_pop_block").find(".J_aftersale_pop");if($aftersalePop.hasClass("z-ui-tooltips-in")){$aftersalePop.removeClass("z-ui-tooltips-in");$(".J_afterSale_btn").find(".i-arrow-up").addClass("f-hidden");$(".J_afterSale_btn").find(".i-arrow-down").removeClass("f-hidden")}var $exchangePop=
$target.parents(".J_exchange").find(".J_exchange_pop_block"),$pop=$exchangePop.find(".J_exchange_pop");if($pop.length>0)$pop.toggleClass("z-ui-tooltips-in");else{for(var k=0;k<exchangeNewOrderSnList.length;k++)newOrderSnList+=exchangeNewOrderSnList[k]+",";if(newOrderSnList.length>0)newOrderSnList=newOrderSnList.substr(0,newOrderSnList.length-1);(function(){that._getData(newOrderSnList).done(function(rtn){that._render(rtn,$exchangePop);$exchangePop.find(".J_exchange_pop").css({top:$target.parents(".J_exchange").find(".J_ex_btn").position().top+
35});$exchangePop.on("click",".J_exchange_show_more",function(e){var $curNode=$(e.currentTarget);var $moreCtr=$curNode.parents(".J_exchange_more_tr");var $moreItem=$moreCtr.siblings(".J_exchange_hide_good");var num=$moreCtr.data("num");$moreCtr.remove();$moreItem.removeClass("f-hidden")})})})()}}})}};$(function(){if(!VIPSHOP.isIE6&&!$.fn.perfectScrollbar)$.Loader.advScript({name:"scrollbar",url:(VIPSHOP.s2StaticJs||VIPSHOP.staticJs)+"/plugins/perfect-scrollbar-0.4.8.with-mousewheel.min.js?"+VIPSHOP.jsVer})});
module.exports=exchangePop},{}],7:[function(require,module,exports){(function(factory){if(typeof define==="function"&&define.amd)define(["jquery"],factory);else factory(typeof jQuery!="undefined"?jQuery:window.Zepto)})(function($){var feature={};feature.fileapi=$("<input type='file'/>").get(0).files!==undefined;feature.formdata=window.FormData!==undefined;var hasProp=!!$.fn.prop;$.fn.attr2=function(){if(!hasProp)return this.attr.apply(this,arguments);var val=this.prop.apply(this,arguments);if(val&&
val.jquery||typeof val==="string")return val;return this.attr.apply(this,arguments)};$.fn.ajaxSubmit=function(options){if(!this.length){log("ajaxSubmit: skipping submit process - no element selected");return this}var method,action,url,$form=this;if(typeof options=="function")options={success:options};else if(options===undefined)options={};method=options.type||this.attr2("method");action=options.url||this.attr2("action");url=typeof action==="string"?$.trim(action):"";url=url||(window.location.href||
"");if(url)url=(url.match(/^([^#]+)/)||[])[1];options=$.extend(true,{url:url,success:$.ajaxSettings.success,type:method||$.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},options);var veto={};this.trigger("form-pre-serialize",[this,options,veto]);if(veto.veto){log("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(options.beforeSerialize&&options.beforeSerialize(this,options)===false){log("ajaxSubmit: submit aborted via beforeSerialize callback");
return this}var traditional=options.traditional;if(traditional===undefined)traditional=$.ajaxSettings.traditional;var elements=[];var qx,a=this.formToArray(options.semantic,elements);if(options.data){options.extraData=options.data;qx=$.param(options.data,traditional)}if(options.beforeSubmit&&options.beforeSubmit(a,this,options)===false){log("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[a,this,options,veto]);if(veto.veto){log("ajaxSubmit: submit vetoed via form-submit-validate trigger");
return this}var q=$.param(a,traditional);if(qx)q=q?q+"&"+qx:qx;if(options.type.toUpperCase()=="GET"){options.url+=(options.url.indexOf("?")>=0?"&":"?")+q;options.data=null}else options.data=q;var callbacks=[];if(options.resetForm)callbacks.push(function(){$form.resetForm()});if(options.clearForm)callbacks.push(function(){$form.clearForm(options.includeHidden)});if(!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push(function(data){var fn=options.replaceTarget?
"replaceWith":"html";$(options.target)[fn](data).each(oldSuccess,arguments)})}else if(options.success)callbacks.push(options.success);options.success=function(data,status,xhr){var context=options.context||this;for(var i=0,max=callbacks.length;i<max;i++)callbacks[i].apply(context,[data,status,xhr||$form,$form])};if(options.error){var oldError=options.error;options.error=function(xhr,status,error){var context=options.context||this;oldError.apply(context,[xhr,status,error,$form])}}if(options.complete){var oldComplete=
options.complete;options.complete=function(xhr,status){var context=options.context||this;oldComplete.apply(context,[xhr,status,$form])}}var fileInputs=$("input[type=file]:enabled",this).filter(function(){return $(this).val()!==""});var hasFileInputs=fileInputs.length>0;var mp="multipart/form-data";var multipart=$form.attr("enctype")==mp||$form.attr("encoding")==mp;var fileAPI=feature.fileapi&&feature.formdata;log("fileAPI :"+fileAPI);var shouldUseFrame=(hasFileInputs||multipart)&&!fileAPI;var jqxhr;
if(options.iframe!==false&&(options.iframe||shouldUseFrame))if(options.closeKeepAlive)$.get(options.closeKeepAlive,function(){jqxhr=fileUploadIframe(a)});else jqxhr=fileUploadIframe(a);else if((hasFileInputs||multipart)&&fileAPI)jqxhr=fileUploadXhr(a);else jqxhr=$.ajax(options);$form.removeData("jqxhr").data("jqxhr",jqxhr);for(var k=0;k<elements.length;k++)elements[k]=null;this.trigger("form-submit-notify",[this,options]);return this;function deepSerialize(extraData){var serialized=$.param(extraData,
options.traditional).split("&");var len=serialized.length;var result=[];var i,part;for(i=0;i<len;i++){serialized[i]=serialized[i].replace(/\+/g," ");part=serialized[i].split("=");result.push([decodeURIComponent(part[0]),decodeURIComponent(part[1])])}return result}function fileUploadXhr(a){var formdata=new FormData;for(var i=0;i<a.length;i++)formdata.append(a[i].name,a[i].value);if(options.extraData){var serializedData=deepSerialize(options.extraData);for(i=0;i<serializedData.length;i++)if(serializedData[i])formdata.append(serializedData[i][0],
serializedData[i][1])}options.data=null;var s=$.extend(true,{},$.ajaxSettings,options,{contentType:false,processData:false,cache:false,type:method||"POST"});if(options.uploadProgress)s.xhr=function(){var xhr=$.ajaxSettings.xhr();if(xhr.upload)xhr.upload.addEventListener("progress",function(event){var percent=0;var position=event.loaded||event.position;var total=event.total;if(event.lengthComputable)percent=Math.ceil(position/total*100);options.uploadProgress(event,position,total,percent)},false);
return xhr};s.data=null;var beforeSend=s.beforeSend;s.beforeSend=function(xhr,o){if(options.formData)o.data=options.formData;else o.data=formdata;if(beforeSend)beforeSend.call(this,xhr,o)};return $.ajax(s)}function fileUploadIframe(a){var form=$form[0],el,i,s,g,id,$io,io,xhr,sub,n,timedOut,timeoutHandle;var deferred=$.Deferred();deferred.abort=function(status){xhr.abort(status)};if(a)for(i=0;i<elements.length;i++){el=$(elements[i]);if(hasProp)el.prop("disabled",false);else el.removeAttr("disabled")}s=
$.extend(true,{},$.ajaxSettings,options);s.context=s.context||s;id="jqFormIO"+(new Date).getTime();if(s.iframeTarget){$io=$(s.iframeTarget);n=$io.attr2("name");if(!n)$io.attr2("name",id);else id=n}else{$io=$('<iframe name="'+id+'" src="'+s.iframeSrc+'" />');$io.css({position:"absolute",top:"-1000px",left:"-1000px"})}io=$io[0];xhr={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(status){var e=
status==="timeout"?"timeout":"aborted";log("aborting upload... "+e);this.aborted=1;try{if(io.contentWindow.document.execCommand)io.contentWindow.document.execCommand("Stop")}catch(ignore){}$io.attr("src",s.iframeSrc);xhr.error=e;if(s.error)s.error.call(s.context,xhr,e,status);if(g)$.event.trigger("ajaxError",[xhr,s,e]);if(s.complete)s.complete.call(s.context,xhr,e)}};g=s.global;if(g&&0===$.active++)$.event.trigger("ajaxStart");if(g)$.event.trigger("ajaxSend",[xhr,s]);if(s.beforeSend&&s.beforeSend.call(s.context,
xhr,s)===false){if(s.global)$.active--;deferred.reject();return deferred}if(xhr.aborted){deferred.reject();return deferred}sub=form.clk;if(sub){n=sub.name;if(n&&!sub.disabled){s.extraData=s.extraData||{};s.extraData[n]=sub.value;if(sub.type=="image"){s.extraData[n+".x"]=form.clk_x;s.extraData[n+".y"]=form.clk_y}}}var CLIENT_TIMEOUT_ABORT=1;var SERVER_ABORT=2;function getDoc(frame){var doc=null;try{if(frame.contentWindow)doc=frame.contentWindow.document}catch(err){log("cannot get iframe.contentWindow document: "+
err)}if(doc)return doc;try{doc=frame.contentDocument?frame.contentDocument:frame.document}catch(err){log("cannot get iframe.contentDocument: "+err);doc=frame.document}return doc}var csrf_token=$("meta[name=csrf-token]").attr("content");var csrf_param=$("meta[name=csrf-param]").attr("content");if(csrf_param&&csrf_token){s.extraData=s.extraData||{};s.extraData[csrf_param]=csrf_token}function doSubmit(){var t=$form.attr2("target"),a=$form.attr2("action"),mp="multipart/form-data",et=$form.attr("enctype")||
($form.attr("encoding")||mp);form.setAttribute("target",id);if(!method||/post/i.test(method))form.setAttribute("method","POST");if(a!=s.url)form.setAttribute("action",s.url);if(!s.skipEncodingOverride&&(!method||/post/i.test(method)))$form.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});if(s.timeout)timeoutHandle=setTimeout(function(){timedOut=true;cb(CLIENT_TIMEOUT_ABORT)},s.timeout);function checkState(){try{var state=getDoc(io).readyState;log("state = "+state);if(state&&state.toLowerCase()==
"uninitialized")setTimeout(checkState,50)}catch(e){log("Server abort: ",e," (",e.name,")");cb(SERVER_ABORT);if(timeoutHandle)clearTimeout(timeoutHandle);timeoutHandle=undefined}}var extraInputs=[];try{if(s.extraData)for(var n in s.extraData)if(s.extraData.hasOwnProperty(n))if($.isPlainObject(s.extraData[n])&&(s.extraData[n].hasOwnProperty("name")&&s.extraData[n].hasOwnProperty("value")))extraInputs.push($('<input type="hidden" name="'+s.extraData[n].name+'">').val(s.extraData[n].value).appendTo(form)[0]);
else extraInputs.push($('<input type="hidden" name="'+n+'">').val(s.extraData[n]).appendTo(form)[0]);if(!s.iframeTarget)$io.appendTo("body");if(io.attachEvent)io.attachEvent("onload",cb);else io.addEventListener("load",cb,false);setTimeout(checkState,15);try{form.submit()}catch(err){var submitFn=document.createElement("form").submit;submitFn.apply(form)}}finally{form.setAttribute("action",a);form.setAttribute("enctype",et);if(t)form.setAttribute("target",t);else $form.removeAttr("target");$(extraInputs).remove()}}
if(s.forceSync)doSubmit();else setTimeout(doSubmit,10);var data,doc,domCheckCount=50,callbackProcessed;function cb(e){if(xhr.aborted||callbackProcessed)return;doc=getDoc(io);if(!doc){log("cannot access response document");e=SERVER_ABORT}if(e===CLIENT_TIMEOUT_ABORT&&xhr){xhr.abort("timeout");deferred.reject(xhr,"timeout");return}else if(e==SERVER_ABORT&&xhr){xhr.abort("server abort");deferred.reject(xhr,"error","server abort");return}if(!doc||doc.location.href==s.iframeSrc)if(!timedOut)return;if(io.detachEvent)io.detachEvent("onload",
cb);else io.removeEventListener("load",cb,false);var status="success",errMsg;try{if(timedOut)throw"timeout";var isXml=s.dataType=="xml"||(doc.XMLDocument||$.isXMLDoc(doc));log("isXml="+isXml);if(!isXml&&(window.opera&&(doc.body===null||!doc.body.innerHTML)))if(--domCheckCount){log("requeing onLoad callback, DOM not available");setTimeout(cb,250);return}var docRoot=doc.body?doc.body:doc.documentElement;xhr.responseText=docRoot?docRoot.innerHTML:null;xhr.responseXML=doc.XMLDocument?doc.XMLDocument:
doc;if(isXml)s.dataType="xml";xhr.getResponseHeader=function(header){var headers={"content-type":s.dataType};return headers[header.toLowerCase()]};if(docRoot){xhr.status=Number(docRoot.getAttribute("status"))||xhr.status;xhr.statusText=docRoot.getAttribute("statusText")||xhr.statusText}var dt=(s.dataType||"").toLowerCase();var scr=/(json|script|text)/.test(dt);if(scr||s.textarea){var ta=doc.getElementsByTagName("textarea")[0];if(ta){xhr.responseText=ta.value;xhr.status=Number(ta.getAttribute("status"))||
xhr.status;xhr.statusText=ta.getAttribute("statusText")||xhr.statusText}else if(scr){var pre=doc.getElementsByTagName("pre")[0];var b=doc.getElementsByTagName("body")[0];if(pre)xhr.responseText=pre.textContent?pre.textContent:pre.innerText;else if(b)xhr.responseText=b.textContent?b.textContent:b.innerText}}else if(dt=="xml"&&(!xhr.responseXML&&xhr.responseText))xhr.responseXML=toXml(xhr.responseText);try{data=httpData(xhr,dt,s)}catch(err){status="parsererror";xhr.error=errMsg=err||status}}catch(err){log("error caught: ",
err);status="error";xhr.error=errMsg=err||status}if(xhr.aborted){log("upload aborted");status=null}if(xhr.status)status=xhr.status>=200&&xhr.status<300||xhr.status===304?"success":"error";if(status==="success"){if(s.success)s.success.call(s.context,data,"success",xhr);deferred.resolve(xhr.responseText,"success",xhr);if(g)$.event.trigger("ajaxSuccess",[xhr,s])}else if(status){if(errMsg===undefined)errMsg=xhr.statusText;if(s.error)s.error.call(s.context,xhr,status,errMsg);deferred.reject(xhr,"error",
errMsg);if(g)$.event.trigger("ajaxError",[xhr,s,errMsg])}if(g)$.event.trigger("ajaxComplete",[xhr,s]);if(g&&!--$.active)$.event.trigger("ajaxStop");if(s.complete)s.complete.call(s.context,xhr,status);callbackProcessed=true;if(s.timeout)clearTimeout(timeoutHandle);setTimeout(function(){if(!s.iframeTarget)$io.remove();else $io.attr("src",s.iframeSrc);xhr.responseXML=null},100)}var toXml=$.parseXML||function(s,doc){if(window.ActiveXObject){doc=new ActiveXObject("Microsoft.XMLDOM");doc.async="false";
doc.loadXML(s)}else doc=(new DOMParser).parseFromString(s,"text/xml");return doc&&(doc.documentElement&&doc.documentElement.nodeName!="parsererror")?doc:null};var parseJSON=$.parseJSON||function(s){return window["eval"]("("+s+")")};var httpData=function(xhr,type,s){var ct=xhr.getResponseHeader("content-type")||"",xml=type==="xml"||!type&&ct.indexOf("xml")>=0,data=xml?xhr.responseXML:xhr.responseText;if(xml&&data.documentElement.nodeName==="parsererror")if($.error)$.error("parsererror");if(s&&s.dataFilter)data=
s.dataFilter(data,type);if(typeof data==="string")if(type==="json"||!type&&ct.indexOf("json")>=0)data=parseJSON(data);else if(type==="script"||!type&&ct.indexOf("javascript")>=0)$.globalEval(data);return data};return deferred}};$.fn.ajaxForm=function(options){options=options||{};options.delegation=options.delegation&&$.isFunction($.fn.on);if(!options.delegation&&this.length===0){var o={s:this.selector,c:this.context};if(!$.isReady&&o.s){log("DOM not ready, queuing ajaxForm");$(function(){$(o.s,o.c).ajaxForm(options)});
return this}log("terminating; zero elements found by selector"+($.isReady?"":" (DOM not ready)"));return this}if(options.delegation){$(document).off("submit.form-plugin",this.selector,doAjaxSubmit).off("click.form-plugin",this.selector,captureSubmittingElement).on("submit.form-plugin",this.selector,options,doAjaxSubmit).on("click.form-plugin",this.selector,options,captureSubmittingElement);return this}return this.ajaxFormUnbind().bind("submit.form-plugin",options,doAjaxSubmit).bind("click.form-plugin",
options,captureSubmittingElement)};function doAjaxSubmit(e){var options=e.data;if(!e.isDefaultPrevented()){e.preventDefault();$(e.target).ajaxSubmit(options)}}function captureSubmittingElement(e){var target=e.target;var $el=$(target);if(!$el.is("[type=submit],[type=image]")){var t=$el.closest("[type=submit]");if(t.length===0)return;target=t[0]}var form=this;form.clk=target;if(target.type=="image")if(e.offsetX!==undefined){form.clk_x=e.offsetX;form.clk_y=e.offsetY}else if(typeof $.fn.offset=="function"){var offset=
$el.offset();form.clk_x=e.pageX-offset.left;form.clk_y=e.pageY-offset.top}else{form.clk_x=e.pageX-target.offsetLeft;form.clk_y=e.pageY-target.offsetTop}setTimeout(function(){form.clk=form.clk_x=form.clk_y=null},100)}$.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};$.fn.formToArray=function(semantic,elements){var a=[];if(this.length===0)return a;var form=this[0];var formId=this.attr("id");var els=semantic?form.getElementsByTagName("*"):form.elements;var els2;
if(els&&!/MSIE [678]/.test(navigator.userAgent))els=$(els).get();if(formId){els2=$(':input[form="'+formId+'"]').get();if(els2.length)els=(els||[]).concat(els2)}if(!els||!els.length)return a;var i,j,n,v,el,max,jmax;for(i=0,max=els.length;i<max;i++){el=els[i];n=el.name;if(!n||el.disabled)continue;if(semantic&&(form.clk&&el.type=="image")){if(form.clk==el){a.push({name:n,value:$(el).val(),type:el.type});a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y})}continue}v=$.fieldValue(el,
true);if(v&&v.constructor==Array){if(elements)elements.push(el);for(j=0,jmax=v.length;j<jmax;j++)a.push({name:n,value:v[j]})}else if(feature.fileapi&&el.type=="file"){if(elements)elements.push(el);var files=el.files;if(files.length)for(j=0;j<files.length;j++)a.push({name:n,value:files[j],type:el.type});else a.push({name:n,value:"",type:el.type})}else if(v!==null&&typeof v!="undefined"){if(elements)elements.push(el);a.push({name:n,value:v,type:el.type,required:el.required})}}if(!semantic&&form.clk){var $input=
$(form.clk),input=$input[0];n=input.name;if(n&&(!input.disabled&&input.type=="image")){a.push({name:n,value:$input.val()});a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y})}}return a};$.fn.formSerialize=function(semantic){return $.param(this.formToArray(semantic))};$.fn.fieldSerialize=function(successful){var a=[];this.each(function(){var n=this.name;if(!n)return;var v=$.fieldValue(this,successful);if(v&&v.constructor==Array)for(var i=0,max=v.length;i<max;i++)a.push({name:n,value:v[i]});
else if(v!==null&&typeof v!="undefined")a.push({name:this.name,value:v})});return $.param(a)};$.fn.fieldValue=function(successful){for(var val=[],i=0,max=this.length;i<max;i++){var el=this[i];var v=$.fieldValue(el,successful);if(v===null||(typeof v=="undefined"||v.constructor==Array&&!v.length))continue;if(v.constructor==Array)$.merge(val,v);else val.push(v)}return val};$.fieldValue=function(el,successful){var n=el.name,t=el.type,tag=el.tagName.toLowerCase();if(successful===undefined)successful=true;
if(successful&&(!n||(el.disabled||(t=="reset"||(t=="button"||((t=="checkbox"||t=="radio")&&!el.checked||((t=="submit"||t=="image")&&(el.form&&el.form.clk!=el)||tag=="select"&&el.selectedIndex==-1)))))))return null;if(tag=="select"){var index=el.selectedIndex;if(index<0)return null;var a=[],ops=el.options;var one=t=="select-one";var max=one?index+1:ops.length;for(var i=one?index:0;i<max;i++){var op=ops[i];if(op.selected){var v=op.value;if(!v)v=op.attributes&&(op.attributes.value&&!op.attributes.value.specified)?
op.text:op.value;if(one)return v;a.push(v)}}return a}return $(el).val()};$.fn.clearForm=function(includeHidden){return this.each(function(){$("input,select,textarea",this).clearFields(includeHidden)})};$.fn.clearFields=$.fn.clearInputs=function(includeHidden){var re=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var t=this.type,tag=this.tagName.toLowerCase();if(re.test(t)||tag=="textarea")this.value="";else if(t=="checkbox"||
t=="radio")this.checked=false;else if(tag=="select")this.selectedIndex=-1;else if(t=="file")if(/MSIE/.test(navigator.userAgent))$(this).replaceWith($(this).clone(true));else $(this).val("");else if(includeHidden)if(includeHidden===true&&/hidden/.test(t)||typeof includeHidden=="string"&&$(this).is(includeHidden))this.value=""})};$.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)this.reset()})};$.fn.enable=function(b){if(b===
undefined)b=true;return this.each(function(){this.disabled=!b})};$.fn.selected=function(select){if(select===undefined)select=true;return this.each(function(){var t=this.type;if(t=="checkbox"||t=="radio")this.checked=select;else if(this.tagName.toLowerCase()=="option"){var $sel=$(this).parent("select");if(select&&($sel[0]&&$sel[0].type=="select-one"))$sel.find("option").selected(false);this.selected=select}})};$.fn.ajaxSubmit.debug=false;function log(){if(!$.fn.ajaxSubmit.debug)return;var msg="[jquery.form] "+
Array.prototype.join.call(arguments,"");if(window.opera&&window.opera.postError)window.opera.postError(msg)}})},{}],8:[function(require,module,exports){module.exports={api:"/order/cancelOrder?callback=?",CANCELED:1,DISABLED:2,OK:200,params:{ordersn:""},get:function(res){return $.extend(this,{code:res.code,msg:res.msg,modifyEnabled:res.result.modifyEnabled,payOnDelivery:res.result.payOnDelivery,storeSource:res.result.storeSource,tips:res.result.tips})}}},{}],9:[function(require,module,exports){module.exports=
{api:"/order/updateCancelOrder?callback=?",SUCCESS:200,params:{ordersn:"",reasonChoice:"",reasonRemark:""},get:function(res){return{code:res.code,msg:res.msg,result:res.result}}}},{}],10:[function(require,module,exports){module.exports={api:"/order/updateMergeOrder?callback=?",SUCCESS:200,FEFUN_FAIL:3133,params:{snList:"",mainSn:"",customersrc:"",codType:"",codappAccount:""},get:function(res){return{code:res.code,msg:res.msg}}}},{}],11:[function(require,module,exports){module.exports={api:"/order/getMergeOrderList?callback=?",
CANCELED:1,REFUSED:2,EMPTY:4,OK:200,DELIVERY_NO_ALIPAY:5,DELIVERY_ALL_AVAILABLE:6,DELIVERY_NO_POS:7,params:{ordersn:""},get:function(res){return $.extend(this,{code:res.code,msg:res.msg,main:res.result.main,orders:res.result.orders,isCoupon:res.result.isCoupon,payType:res.result.userPayType,alipayList:res.result.taobaoMap||[]})}}},{}],12:[function(require,module,exports){module.exports={api:"/order/modifyOrder?callback=?",CANCELED:1,DISABLED:2,OK:200,params:{ordersn:""},get:function(res){return{code:res.code||
"",msg:res.msg||"",redirect:res.result&&res.result.redirect||""}}}},{}],13:[function(require,module,exports){module.exports={api:"/pay/codCheck?callback=?",MOBILE_ONLY:12,DONE:1,CANCELED:2,ONCEMORE_DEAL:7,ONCEMORE_NO_DEAL:3,ONCEMORE_NOT_ON_DELIVERY:4,PART_IN_STOCK:5,NO_STOCK:6,SUCCESS:200,params:{ordersn:"",money:"",areaCode:"",mobile:"",tel:""},get:function(res){var hasOtherType=false;var fromMobile=false;var cashAble=false;var isTe=false;var code=res.code;var hasDeal=false;if(code===this.SUCCESS)if(res.result.payResult){cashAble=
res.result.cashResult;hasOtherType=res.result.channel==0||res.result.channel==1;fromMobile=res.result.clientType==2;hasDeal=res.result.exPaySubtotal>0}else code=this.PART_IN_STOCK;return{hasDeal:hasDeal,cashAble:cashAble,hasOtherType:hasOtherType,fromMobile:fromMobile,code:code,msg:res.msg,stockList:res.result.stockList,noStockList:res.result.noStockList,redirect:res.result.redirect,callback:res.result.callback,otherPayUrl:res.result.otherPayUrl,clientType:res.result.clientType,channel:res.result.channel,
mobilePayResult:res.result.mobilePayResult}}}},{}],14:[function(require,module,exports){module.exports={api:"/order/saleAgo?callback=?",OK:200,params:{ordersn:""},get:function(res){return{code:res.code,msg:res.msg}}}},{}],15:[function(require,module,exports){module.exports={api:"/order/deleteOrder?callback=?",SUCCESS:200,params:{ordersn:""},get:function(res){return{code:res.code,msg:res.msg}}}},{}],16:[function(require,module,exports){module.exports={api:"/order/returnedOrder?callback=?",REFUSED:1,
REPEAT:2,SUCCESS:200,params:{ordersn:""},get:function(res){return{code:res.code,msg:res.msg,redirect:res.result.redirect}}}},{}],17:[function(require,module,exports){module.exports={api:"/order/updateCancelReturnedOrder?callback=?",CANCELED:1,DISABLED:2,SUCCESS:200,params:{ordersn:""},get:function(res){return{code:res.code,msg:res.msg}}}},{}],18:[function(require,module,exports){module.exports=function(tpl,values){return tpl.replace(/\{\{\s*(.+?)\s*\}\}/g,function(m,v){return values[v]||""})}},{}],
19:[function(require,module,exports){module.exports={api:"//order.vip.com/ops/getOrderTrackFromList",SUCCESS:200,params:{orderSn:""},get:function(res){var list=[];if(res&&(res.result&&res.result.length>0))list=res.result[0].timeline;return{code:res.code,list:list}}}},{}],20:[function(require,module,exports){function Modal(options){this.trigger=options.trigger?$(options.trigger):null;this.element=$(options.element);this.centered=typeof options.centered==="undefined"?true:options.centered;options.mask=
typeof options.mask==="undefined"?true:options.mask;if(options.mask){var $mask=$("body").children(".pure-modal-backdrop");this.mask=$mask.length>0?$mask:$('<div class="pure-modal-backdrop"/>').appendTo("body");this.mask.hide()}if(this.trigger)this.trigger.click($.proxy(this.show,this));this.element.on("click",".J_close",$.proxy(this.hide,this))}Modal.prototype.setElement=function(el){this.element=$(el);this.element.off("click",".J_close",$.proxy(this.hide,this)).on("click",".J_close",$.proxy(this.hide,
this))};Modal.prototype.show=function(){this.element.show();var isIE6="undefined"==typeof document.body.style.maxHeight;if(this.centered)if(isIE6)this.element.css({top:$(document).scrollTop()+($(window).height()-this.element.height())/2,position:"absolute"});else this.element.css({top:($(window).height()-this.element.height())/2,position:"fixed"});if(this.mask)if(isIE6)this.mask.css({position:"absolute",height:$(document).height()}).show();else this.mask.show()};Modal.prototype.hide=function(){this.element.hide();
if(this.mask)this.mask.hide();return false};module.exports=Modal},{}],21:[function(require,module,exports){var Cart=require("../../../bo/te/cart/3/Cart.js");var rebuy={ORDER_CHECK_API:"//order.vip.com/multList/checkOpsByOrders",ORDER_REBUY_API:"//order.vip.com/multDetail/purchase/info",DIRECT_BUY_API:"//checkout.vip.com/te2/buyCheck.php",BUY_SCENE:{LIST_BUY:"orderlist-buyagain\t",DETAIL_BUY:"orderdetail-buyagain",PART_BUY:"partgoods-buyagain",DIRECT_BUY:"partgoods-direct-hibuy"},PAGE:{LIST:"LIST",
DETAIL:"DETAIL"},currPage:null,$cnt:null,rebuyBtnTpl:'<p><a class="ui-btn-mini ui-btn-secondary J_rebuy" role="button" mars_sead="te_buy_cart_btn" href="javascript:;">\u518d\u6b21\u8d2d\u4e70</a></p>',textTpl:'<h3 class="ui-dialog-tips f-text-center"><span class="text"><i class="vipFont if-sigh">\ue603</i>{{text}}</span></h3>',init:function(fromPage){if(fromPage===1)this.currPage=this.PAGE.DETAIL;else this.currPage=this.PAGE.LIST;return this},checkOrders:function($orderList){this.$cnt=$orderList;
var _this=this;var params=this._getListParams($orderList);if(params)this._loadData({param:$.stringifyJSON(params)}).then(function(result){_this._showRebuyBtns(result)},function(res){_this._alertMsg(res&&res.msg)})},_getListParams:function($cnt){var params=[];var $tbody=$cnt.find('tbody[data-rebuy="true"]');if($tbody.length){$tbody.each(function(i,item){params.push($(item).data("ordersn"))});return params}return null},_loadData:function(params){return $.ajax({url:this.ORDER_CHECK_API,method:"POST",
dataType:"json",data:params}).then(function(res){if(res&&res.code===200)return res.result;return $.Deferred().reject(res)})},_showRebuyBtns:function(ordersMap){var _this=this;var $tbody=this.$cnt.find('tbody[data-rebuy="true"]');for(var orderSn in ordersMap)if(ordersMap[orderSn].rebuyOtherFlag)$tbody.each(function(i,item){var $el=$(item);if($el.data("ordersn")==orderSn)$el.find("td.control").append(_this.rebuyBtnTpl)})},_alertMsg:function(option){var msg="";if(typeof option==="string")option={text:option};
if(!option)option={text:"\u518d\u6b21\u8d2d\u4e70\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5"};msg=this.textTpl.replace("{{text}}",option.text);var dialog=$.Dialog({model:true,content:msg,button:[{text:"\u786e\u5b9a",type:"primary",event:function(){dialog.destroy()}}],closeEvent:function(){option.callback&&option.callback()}}).open()},_addCart:function(data,buyBrands,buyGoods,sceneId){var _this=this;Cart.add(data,function(res,isSuccess,paramData){_this.afterAdd(res,isSuccess,paramData)},{},{brand_id:buyBrands.join(","),
goods_id:buyGoods.join(","),scene_id:sceneId})},_sendMar:function(key,val){window.Mar&&window.Mar.Seed.request("a","click",key,val)},_showShortPop:function(data,callback){var _this=this;var buttons=null;if(!data._showDirectBtn)buttons=[{text:"\u786e\u8ba4\u8d2d\u4e70",type:"primary",event:function(){_this._sendMar("te_buy_cart_btn");callback&&callback()}}];var dialog=$.Dialog({title:"\u5546\u54c1\u4fe1\u606f\u786e\u8ba4",model:true,content:$.Tpl("J_rebuyPopTpl",data),size:"super",elStyle:"dialog-rebuy-pop",
button:buttons,showEvent:function(){var $container=this.dialogTemplates;var $header=$container.find(".J_data_table thead");var cp_header=$header.clone(true);var $cp_th=cp_header.find("th");$header.find("th").each(function(i,item){$cp_th.eq(i).width($(this).width())});$container.find(".J_fixed_header").find("table").html(cp_header).end().removeClass("hidden");_this._addScrollBar($container.find(".m-rebuy-list"));if(data._showDirectBtn)_this._initDirectBuyEvent($container)},closeEvent:function(){var $container=
this.dialogTemplates;_this._removeScrollBar($container.find(".m-rebuy-list"));if(data._showDirectBtn)_this._removeDirectBuyEvent($container);_this._sendMar("buyagain_cart_close_btn")}}).open()},_doDirectBuy:function(params,marsObj){var _this=this;this._sendMar("te_direct_hibuy_btn");return $.ajax({url:this.DIRECT_BUY_API,data:params,dataType:"jsonp",success:function(res){if(res.code===200){$.Listeners.pub(Cart.events.addMars).success(marsObj);location.href=res.redirect}else _this._alertMsg(res.msg)}})},
_initDirectBuyEvent:function($container){var _this=this;$container.on("click",".J_directBuyBtn",function(e){var $el=$(e.target).closest("tr");if($el.data("loading"))return;$el.data("loading",1);_this._doDirectBuy({num:$el.data("num"),size_id:$el.data("sizeid"),from:$el.data("independent")},{scene_id:_this.BUY_SCENE.DIRECT_BUY,brand_id:$el.data("brandid"),goods_id:$el.data("goodsid")}).always(function(){$el.removeData("loading")})})},_removeDirectBuyEvent:function($container){$container.off("click",
"J_directBuyBtn")},_addScrollBar:function($cnt){if($.fn.perfectScrollbar)$cnt.perfectScrollbar({wheelSpeed:40})},_removeScrollBar:function($cnt){$cnt.perfectScrollbar&&$cnt.perfectScrollbar("destroy")},_showEmptyPop:function(){var dialog=$.Dialog({model:true,content:this.textTpl.replace("{{text}}","\u5546\u54c1\u7f3a\u8d27\u6216\u6682\u672a\u5f00\u552e\uff0c\u518d\u53bb\u901b\u901b\u5176\u4ed6\u5546\u54c1\u5427"),button:[{text:"\u6211\u77e5\u9053\u4e86",type:"primary",event:function(){dialog.destroy()}},
{text:"\u53bb\u9996\u9875\u901b\u901b",event:function(){location.href="//www.vip.com"}}]}).open()},tryRebuy:function(orderSn){var _this=this;return $.ajax({url:this.ORDER_REBUY_API,data:{orderSn:orderSn},method:"GET"}).done(function(res){if(res&&res.code===200){var params=[];var buyBrands=[];var buyGoods=[];var isShort=false;var total=0;var hasDirect=false;var data={_showTip:true,_showDirectBtn:true,goodsList:res.result.goodsList};$.each(data.goodsList,function(i,item){total+=item.num;if(!item.independent&&
item.num>0)data._showDirectBtn=false;if(item.independent)hasDirect=true});$.each(data.goodsList,function(i,item){if(item.num<=0){isShort=true;item._emptyCls="goodsEmpty"}if(item.independent&&!data._showDirectBtn)item._emptyCls="goodsEmpty";if(!item._emptyCls){params.push({size_id:item.sizeId,num:item.num});buyBrands.push(item.brandId);buyGoods.push(item.goodsId)}});if(!isShort&&data._showDirectBtn)data._showTip=false;if(data.goodsList&&data.goodsList.length>1)data.goodsList.sort(function(a,b){return a._emptyCls?
1:-1});if(total===0)_this._showEmptyPop(data);else if(data.goodsList.length===1&&hasDirect){params[0].from=data.goodsList[0].independent;_this._doDirectBuy(params[0],{scene_id:_this.BUY_SCENE.DIRECT_BUY,brand_id:buyBrands.join(","),goods_id:buyGoods.join(",")})}else if(isShort||hasDirect)_this._showShortPop(data,function(){_this._addCart(params,buyBrands,buyGoods,_this.BUY_SCENE.PART_BUY)});else _this._addCart(params,buyBrands,buyGoods,_this.currPage===_this.PAGE.LIST?_this.BUY_SCENE.LIST_BUY:_this.BUY_SCENE.DETAIL_BUY)}else _this._alertMsg(res&&
res.msg)}).fail(function(res){_this._alertMsg(res&&res.msg)})},afterAdd:function(res,isSuccess,paramData){if(res.result===-1)location.href=VIPSHOP.userHost+"/login?gotype=1&src="+encodeURIComponent(location.protocol+"//"+location.hostname+location.pathname);else if(res.result===1||res.code===200)location.href="//cart.vip.com/te2/";else this._alertMsg(res.msg)}};$(function(){if(!VIPSHOP.isIE6&&!$.fn.perfectScrollbar)$.Loader.advScript({name:"scrollbar",url:(VIPSHOP.s2StaticJs||VIPSHOP.staticJs)+"/plugins/perfect-scrollbar-0.4.8.with-mousewheel.min.js?"+
VIPSHOP.jsVer})});module.exports=rebuy},{"../../../bo/te/cart/3/Cart.js":2}],22:[function(require,module,exports){module.exports=require(18)},{}],23:[function(require,module,exports){var Cid={creat:function(){var that=this;return this.encrypt(that._pad((new Date).getTime(),13)+"_"+that._rand())},encrypt:function(timestamp_mar_id){var mar_arr=timestamp_mar_id.split("_");var timestamp=mar_arr[0];var mar_id=mar_arr[1];if(!timestamp||!mar_id)return timestamp_mar_id;var timestamp_sum=0;var timestamp_len=
timestamp.length;for(var i=0;i<timestamp_len;i++)timestamp_sum+=parseInt(timestamp[i]);var replace_index=timestamp_sum%32;var dechex_sum=timestamp_sum;var mar_id_len=mar_id.length;for(var i=0;i<mar_id_len;i++)if(i!==replace_index)dechex_sum+=parseInt(mar_id[i],16);var replace_value=(dechex_sum%16).toString(16);return timestamp+"_"+mar_id.substr(0,replace_index)+replace_value.toString()+mar_id.substr(replace_index+1,mar_id_len)},_pad:function(num,n){var len=num.toString().length;while(len<n){num="0"+
num;len++}return num},_rand:function(len){var x="0123456789abcdef",tmp="",i=0;len=len||32;for(;i<len;i++)tmp+=x.charAt(Math.ceil(Math.random()*1E8)%x.length);return tmp}};module.exports=Cid},{}],24:[function(require,module,exports){var $http={init:function(opt){if(window.AJAX_CACHE==undefined)window.AJAX_CACHE={};var that=this;var set={url:"",data:{},cache:false,dataType:"jsonp",jsonpCallback:"jsonpCallback",type:"GET",dataFilter:function(data,type){return data},timeout:8E3,lock:false,preFilter:function(cb){cb()},
filter:null,isCache:false,cacheKeys:[],cacheObj:window.AJAX_CACHE,code:"",event:{ajaxLock:"ajax.lock",ajaxUnlock:"ajax.unlock"},successCallback:null,errorCallback:null,ajaxTryTimes:0};$.extend(set,opt);if(set.filter==null)this.filter=function(rtnData,set,callback){return callback(rtnData)};else this.filter=opt.filter;this.cache={getkey:function(cacheKeys,ajaxParam){var cachekey_list=[];$.each(cacheKeys,function(i,key){cachekey_list.push(ajaxParam[key])});return cachekey_list.join("_")},get:function(cacheKeys,
ajaxParam){var cachekey=this.getkey(cacheKeys,ajaxParam);return set.cacheObj[cachekey]},set:function(cacheKeys,ajaxParam,rtnData){var cachekey=this.getkey(cacheKeys,ajaxParam);set.cacheObj[cachekey]=rtnData}};this.ajaxFun=function(set){$.ajax({url:set.url,data:set.data,cache:set.cache,dataType:set.dataType,type:set.type,dataFilter:set.dataFilter,jsonpCallback:set.jsonpCallback,timeout:set.timeout,success:function(rtnData,textStatus,jqXHR){if(set.lock)$.Listeners.pub(set.event.ajaxUnlock).success();
that.filter(rtnData,set,function(successCallbackData){if(set.isCache)that.cache.set(set.cacheKeys,set.data,successCallbackData);if(set.successCallback!=null)set.successCallback(successCallbackData)})},error:function(XMLHttpRequest,textStatus,errorThrown){var errorObj={ext:{requestUrl:this.url,textStatus:textStatus,status:XMLHttpRequest.status}};if(set.lock)$.Listeners.pub(set.event.ajaxUnlock).success();if(set.ajaxTryTimes>0){set.ajaxTryTimes--;that.ajaxFun(set)}else if(set.errorCallback!=null)set.errorCallback(XMLHttpRequest,
textStatus,errorThrown);if(set.code!="")VIPSHOP.report.send&&VIPSHOP.report.send(set.code,errorObj)}})};set.preFilter(function(){if(set.isCache&&that.cache.get(set.cacheKeys,set.data)!=undefined){if(set.successCallback!=null){var cacheData=that.cache.get(set.cacheKeys,set.data);set.successCallback(cacheData)}}else{if(set.lock)$.Listeners.pub(set.event.ajaxLock).success();that.ajaxFun(set)}});return this}};var nsHttp=function(opt){$http.init(opt)};module.exports=nsHttp},{}],25:[function(require,module,
exports){var template=require("./lib/template");template.helper("cutter",function(txt,length){if(txt.length>length)return txt.substr(0,length-1)+"...";else return txt});template.helper("delProtocolHeader",function(str){str=str.replace(/^http:|https:/i,"");return str});template.helper("descnFormat",function(str){str=str.replace(/([0-9.]+[\u5143\u6298\u4ef6]?)/g,function(){return'<span class="u-price">'+arguments[1]+"</span>"});return str});template.helper("formatNumber",function(str){str=str.replace(/(0-9.)/g,
function(){return'<span class="u-price">'+arguments[1]+"</span>"});return str});template.helper("formatNumber",function(str){str=str.replace(/(0-9.)/g,function(){return'<span class="u-price">'+arguments[1]+"</span>"});return str});template.helper("encrypt",function(str,type){var re="";if(str!="")switch(type){case "cardNo":re=str.substr(0,4)+"**"+str.substr(str.length-4,4);break}return re});template.helper("buyMoreLink",function(brandStr,diff){var diffStr=diff==undefined?0:diff;var link="";if(brandStr==
""){if(diffStr==0)diffStr=100;link="//viva.vip.com/act/templateCollage-pc?wapid=vivac_1008&diff="+diffStr}else link="//viva.vip.com/act/templateCollage-pc?wapid=vivac_1008&brand="+brandStr+"&diff="+diffStr;return link});module.exports=template},{"./lib/template":26}],26:[function(require,module,exports){!function(){function a(a){return a.replace(t,"").replace(u,",").replace(v,"").replace(w,"").replace(x,"").split(/^$|,+/)}function b(a){return"'"+a.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,
"\\n")+"'"}function c(c,d){function e(a){return m+=a.split(/\n/).length-1,k&&(a=a.replace(/\s+/g," ").replace(/\x3c!--.*?--\x3e/g,"")),a&&(a=s[1]+b(a)+s[2]+"\n"),a}function f(b){var c=m;if(j?b=j(b,d):g&&(b=b.replace(/\n/g,function(){return m++,"$line="+m+";"})),0===b.indexOf("=")){var e=l&&!/^=[=#]/.test(b);if(b=b.replace(/^=[=#]?|[\s;]*$/g,""),e){var f=b.replace(/\s*\([^\)]+\)/,"");n[f]||(/^(include|print)$/.test(f)||(b="$escape("+b+")"))}else b="$string("+b+")";b=s[1]+b+s[2]}return g&&(b="$line="+
c+";"+b),r(a(b),function(a){if(a&&!p[a]){var b;b="print"===a?u:"include"===a?v:n[a]?"$utils."+a:o[a]?"$helpers."+a:"$data."+a,w+=a+"="+b+",",p[a]=!0}}),b+"\n"}var g=d.debug,h=d.openTag,i=d.closeTag,j=d.parser,k=d.compress,l=d.escape,m=1,p={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},q="".trim,s=q?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],t=q?"$out+=text;return $out;":"$out.push(text);",u="function(){var text=''.concat.apply('',arguments);"+t+"}",v=
"function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+t+"}",w="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(g?"$line=0,":""),x=s[0],y="return new String("+s[3]+");";r(c.split(h),function(a){a=a.split(i);var b=a[0],c=a[1];1===a.length?x+=e(b):(x+=f(b),c&&(x+=e(c)))});var z=w+x+y;g&&(z="try{"+z+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+b(c)+".split(/\\n/)[$line-1].replace(/^\\s+/,'')};}");try{var A=
new Function("$data","$filename",z);return A.prototype=n,A}catch(B){throw B.temp="function anonymous($data,$filename) {"+z+"}",B;}}var d=function(a,b){return"string"==typeof b?q(b,{filename:a}):g(a,b)};d.version="3.0.0",d.config=function(a,b){e[a]=b};var e=d.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},f=d.cache={};d.render=function(a,b){return q(a,b)};var g=d.renderFile=function(a,b){var c=d.get(a)||p({filename:a,name:"Render Error",message:"Template not found"});
return b?c(b):c};d.get=function(a){var b;if(f[a])b=f[a];else if("object"==typeof document){var c=document.getElementById(a);if(c){var d=(c.value||c.innerHTML).replace(/^\s*|\s*$/g,"");b=q(d,{filename:a})}}return b};var h=function(a,b){return"string"!=typeof a&&(b=typeof a,"number"===b?a+="":a="function"===b?h(a.call(a)):""),a},i={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},j=function(a){return i[a]},k=function(a){return h(a).replace(/&(?![\w#]+;)|[<>"']/g,j)},l=Array.isArray||function(a){return"[object Array]"===
{}.toString.call(a)},m=function(a,b){var c,d;if(l(a))for(c=0,d=a.length;d>c;c++)b.call(a,a[c],c,a);else for(c in a)b.call(a,a[c],c)},n=d.utils={$helpers:{},$include:g,$string:h,$escape:k,$each:m};d.helper=function(a,b){o[a]=b};var o=d.helpers=n.$helpers;d.onerror=function(a){var b="Template Error\n\n";for(var c in a)b+="<"+c+">\n"+a[c]+"\n\n";"object"==typeof window["console"]&&window["console"].error(b)};var p=function(a){return d.onerror(a),function(){return"{Template Error}"}},q=d.compile=function(a,
b){function d(c){try{return new i(c,h)+""}catch(d){return b.debug?p(d)():(b.debug=!0,q(a,b)(c))}}b=b||{};for(var g in e)void 0===b[g]&&(b[g]=e[g]);var h=b.filename;try{var i=c(a,b)}catch(j){return j.filename=h||"anonymous",j.name="Syntax Error",p(j)}return d.prototype=i.prototype,d.toString=function(){return i.toString()},h&&(b.cache&&(f[h]=d)),d},r=n.$each,s="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",
t=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,u=/[^\w$]+/g,v=new RegExp(["\\b"+s.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),w=/^\d[^,]*|,\d[^,]*/g,x=/^,+|,+$/g;e.openTag="{{",e.closeTag="}}";var y=function(a,b){var c=b.split(":"),d=c.shift(),e=c.join(":")||"";return e&&(e=", "+e),"$helpers."+d+"("+a+e+")"};e.parser=function(a,b){a=a.replace(/^\s/,"");var c=a.split(" "),e=c.shift(),f=c.join(" ");switch(e){case "if":a="if("+f+"){";break;
case "else":c="if"===c.shift()?" if("+c.join(" ")+")":"",a="}else"+c+"{";break;case "/if":a="}";break;case "each":var g=c[0]||"$data",h=c[1]||"as",i=c[2]||"$value",j=c[3]||"$index",k=i+","+j;"as"!==h&&(g="[]"),a="$each("+g+",function("+k+"){";break;case "/each":a="});";break;case "echo":a="print("+f+");";break;case "print":case "include":a=e+"("+c.join(",")+");";break;default:if(-1!==f.indexOf("|")){var l=b.escape;0===a.indexOf("#")&&(a=a.substr(1),l=!1);for(var m=0,n=a.split("|"),o=n.length,p=l?
"$escape":"$string",q=p+"("+n[m++]+")";o>m;m++)q=y(q,n[m]);a="=#"+q}else a=d.helpers[e]?"=#"+e+"("+c.join(",")+");":"="+a}return a},"undefined"!=typeof exports?module.exports=d:"function"==typeof define?define(function(){return d}):this.template=d}()},{}],27:[function(require,module,exports){var template=require("../../template");var CommonPop=function(customConfig){this._init(customConfig)};$.extend(CommonPop.prototype,{defaultConfig:{tmplId:"",okClass:"J_pop_ok",cancelClass:"J_pop_cancel",closeClass:"J_pop_close",
onOpen:null,onFirstOpen:null,onOk:null,onClose:null,popConfig:{title:"",content:"",custom:true,model:true,elStyle:"",opacity:0.6,zIndex:100}},_init:function(customConfig){var that=this;this.config=$.extend(true,{},this.defaultConfig,customConfig);this.openYet=false;this.isOpening=false;this.tmplId=this.config.tmplId;var config=$.extend(true,{showEvent:function(){setTimeout(function(){if(!that.openYet){that.config.onFirstOpen&&that.config.onFirstOpen.call(that);that._bindEvent();that.openYet=true}that.config.onOpen&&
that.config.onOpen.call(that)},0)}},this.config.popConfig);this.pop=new $.Dialog(config);this.popContainer=this.pop.buffObj.dialog},_bindEvent:function(){var that=this;$.each(["ok","cancel","close"],function(i,name){that.popContainer.on("click","."+that.config[name+"Class"],function(e){var jqThis=$(e.target);var href=jqThis.attr("href");if(!href||(href.indexOf("javascript:void")==0||href.indexOf("###")==0))e.preventDefault();var cbFun=that.config["on"+name.substr(0,1).toUpperCase()+name.substr(1,
name.length)];if($.isFunction(cbFun))cbFun.call(that,function(){that.close()});else that.close()})})},open:function(data){this.isOpening=true;if(this.tmplId)this.pop.open().content(template(this.tmplId,data));else this.pop.open().content(data)},title:function(str){this.pop.title(str)},close:function(isQuiet){var that=this;if(!isQuiet&&this.config.onClose)this.config.onClose.call(this,function(){that.isOpening=false;that.pop.close()});else{this.isOpening=false;this.pop.close()}}});module.exports=CommonPop},
{"../../template":25}],28:[function(require,module,exports){var urlParamMod={genLocation:function(str){var ary=str.split("&"),obj={};ary.map(function(item){var r=item.split("=");if(r.length){var key=r[0];var value;try{value=decodeURIComponent(r.slice(1,r.length).join("="))}catch(e){value=r.slice(1,r.length).join("=")}obj[key]=value}});return obj},query:function(key){var obj=this.genLocation(location.search.substr(1));if(key)return obj[key];return obj},get:function(addParam){var address=$.parseJSON(decodeURIComponent(escape($.Cookie.get("vip_address")))),
sid=address.sid,cid=address.cid,commParam={app_name:"shop_pc",app_version:1,warehouse:$.Cookie.get("vip_wh")||"VIP_NH",fdc_area_id:sid||(cid||104104101),client:"pc",mobile_platform:1,province_id:$.Cookie.get("vip_province"),api_key:"70f71280d5d547b2a7bb370a529aeea1",user_id:$.Cookie.get("VipRUID"),mars_cid:$.Cookie.get("mars_cid")||"shop_pc"};return $.extend(commParam,addParam||{})}};module.exports=urlParamMod},{}]},{},[3]);
